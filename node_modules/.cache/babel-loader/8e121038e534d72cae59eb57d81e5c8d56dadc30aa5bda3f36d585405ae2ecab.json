{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\VivekReddyMeka\\\\Desktop\\\\Accounts_Management\\\\src\\\\Components\\\\Dashboard.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { Building2, Code } from 'lucide-react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport OrganizationSelector from './OrganizationSelector';\nimport CompanyDashboard from './CompanyDashboard';\nimport ProjectDashboard from './ProjectDashboard';\nimport Header from './Header';\nimport '../Styles/Dashboard.css';\nimport * as XLSX from 'xlsx';\nimport Papa from 'papaparse';\nimport { calculateDashboardMetrics, getBreakdownByCategory } from '../utils/Calculations';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = 'http://localhost:3001';\nconst dbFields = ['OrganizationID', 'OrgName', 'TxnID', 'TxnDate', 'Category', 'Item', 'Type', 'Amount', 'ProjectID', 'ProjectName'];\nconst DashboardCard = ({\n  title,\n  value,\n  color,\n  onClick\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  style: {\n    flex: '1 1 0',\n    background: color,\n    color: '#fff',\n    borderRadius: 12,\n    padding: '32px 24px',\n    textAlign: 'center',\n    boxShadow: '0 2px 8px #0002',\n    minWidth: 200,\n    fontSize: 20,\n    cursor: onClick ? 'pointer' : 'default'\n  },\n  onClick: onClick,\n  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontSize: 18,\n      marginBottom: 8\n    },\n    children: title\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontSize: 32,\n      fontWeight: 700\n    },\n    children: title === 'Net Margin (%)' ? `${value}%` : `₹${Number(value).toLocaleString()}`\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 19,\n  columnNumber: 3\n}, this);\n_c = DashboardCard;\nconst BreakdownModal = ({\n  type,\n  breakdown,\n  onClose\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  style: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: '100vw',\n    height: '100vh',\n    background: '#0007',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    zIndex: 9999\n  },\n  children: /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      background: '#fff',\n      borderRadius: 10,\n      padding: 32,\n      minWidth: 400\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: [type.charAt(0).toUpperCase() + type.slice(1), \" Breakdown by Category\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n      style: {\n        width: '100%',\n        marginTop: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Category\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 53,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 54,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: Object.entries(breakdown).map(([cat, amt]) => /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: cat\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: [\"\\u20B9\", amt.toLocaleString()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 15\n          }, this)]\n        }, cat, true, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      style: {\n        marginTop: 24\n      },\n      onClick: onClose,\n      children: \"Close\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 44,\n  columnNumber: 3\n}, this);\n_c2 = BreakdownModal;\nconst Dashboard = ({\n  isLoggedIn,\n  onLogout\n}) => {\n  _s();\n  var _location$state, _location$state2;\n  const location = useLocation();\n  const navigate = useNavigate();\n  const userEmail = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.userEmail) || '';\n  const organizationId = ((_location$state2 = location.state) === null || _location$state2 === void 0 ? void 0 : _location$state2.organizationId) || null;\n\n  // --- State declarations ---\n  const [view, setView] = useState(() => localStorage.getItem('dashboardView') || 'organizations');\n  const [selectedOrg, setSelectedOrg] = useState(null);\n  const [selectedDept, setSelectedDept] = useState('all');\n  const [selectedProject, setSelectedProject] = useState(null);\n  const [organizations, setOrganizations] = useState([]);\n  const [rawProjects, setRawProjects] = useState([]);\n  const [departments, setDepartments] = useState([]);\n  const [showNewProjectForm, setShowNewProjectForm] = useState(false);\n  const [loading, setLoading] = useState(false);\n\n  // --- Excel/DB Import states ---\n  const [excelData, setExcelData] = useState([]);\n  const [excelColumns, setExcelColumns] = useState([]);\n  const [columnMap, setColumnMap] = useState({});\n  const [uploadFileName, setUploadFileName] = useState('');\n  const [importedRows, setImportedRows] = useState([]);\n  const [projectsFromDB, setProjectsFromDB] = useState([]);\n  const [step, setStep] = useState(1);\n\n  // --- Modal state for breakdown ---\n  const [modalView, setModalView] = useState(null); // 'ar', 'ap', 'profit', 'loss', null\n\n  // --- Prevent access to other organizations by direct URL ---\n  useEffect(() => {\n    if (selectedOrg && String(selectedOrg.id) !== String(organizationId)) {\n      setView('organizations');\n      setSelectedOrg(null);\n    }\n  }, [selectedOrg, organizationId]);\n\n  // --- Load organizations ---\n  useEffect(() => {\n    const loadOrgs = async () => {\n      try {\n        const res = await fetch(`${API_BASE}/organizations`);\n        const data = await res.json();\n        const mapped = data.map(o => ({\n          id: o.OrganizationID,\n          name: o.Name,\n          type: o.Type || '',\n          description: o.Description || '',\n          // Use icon and color from DB, fallback if missing\n          icon: o.icon === 'Code' ? Code : Building2,\n          color: o.color || '#3b82f6'\n        }));\n        setOrganizations(mapped);\n      } catch (err) {\n        console.error('Error loading organizations:', err);\n      }\n    };\n    loadOrgs();\n  }, []);\n\n  // --- Organization selection ---\n  const handleOrgSelect = async orgId => {\n    setLoading(true);\n    setSelectedDept('all');\n    setSelectedProject(null);\n    setView('dashboard');\n    setStep(1);\n\n    // --- Clear previous organization data ---\n    // setImportedRows([]);\n    // setProjectsFromDB([]);\n    // localStorage.removeItem('importedRows');\n    // localStorage.removeItem('selectedOrg');\n\n    try {\n      var _organizations$find, _organizations$find2, _organizations$find3, _organizations$find4, _organizations$find5;\n      // Fetch organization, projects, departments for the selected org\n      const orgRes = await fetch(`${API_BASE}/organizations/${orgId}`);\n      const orgData = await orgRes.json();\n      const projRes = await fetch(`${API_BASE}/projects?organizationId=${orgId}`);\n      const projRows = await projRes.json();\n      const deptRes = await fetch(`${API_BASE}/departments?organizationId=${orgId}`);\n      const deptRows = await deptRes.json();\n\n      // --- Fetch transactions for this organization ---\n      const importedRes = await fetch(`${API_BASE}/imported-transactions?organizationId=${orgId}`);\n      const imported = await importedRes.json();\n      setImportedRows(imported);\n      localStorage.setItem('importedRows', JSON.stringify(imported));\n\n      // --- Fetch project financials for this organization ---\n      const projFinRes = await fetch(`${API_BASE}/project-financials?organizationId=${orgId}`);\n      const projFin = await projFinRes.json();\n      setProjectsFromDB(Array.isArray(projFin) ? projFin : []);\n      const mappedProjects = (projRows || []).map(p => {\n        var _ref, _p$Budget, _ref2, _p$Spending, _ref3, _p$Budget2, _ref4, _p$Spending2, _ref5, _p$AR, _ref6, _p$AP, _ref7, _p$Spending3, _ref8, _p$Team;\n        return {\n          id: p.ProjectID || p.ProjectId || p.id,\n          name: p.ProjectName || p.Name || p.name || '',\n          status: (p.Status || p.status || '').toString(),\n          budget: Number((_ref = (_p$Budget = p.Budget) !== null && _p$Budget !== void 0 ? _p$Budget : p.budget) !== null && _ref !== void 0 ? _ref : 0),\n          spent: Number((_ref2 = (_p$Spending = p.Spending) !== null && _p$Spending !== void 0 ? _p$Spending : p.spent) !== null && _ref2 !== void 0 ? _ref2 : 0),\n          profit: Number(p.Profit !== undefined ? p.Profit : Number((_ref3 = (_p$Budget2 = p.Budget) !== null && _p$Budget2 !== void 0 ? _p$Budget2 : p.budget) !== null && _ref3 !== void 0 ? _ref3 : 0) - Number((_ref4 = (_p$Spending2 = p.Spending) !== null && _p$Spending2 !== void 0 ? _p$Spending2 : p.spent) !== null && _ref4 !== void 0 ? _ref4 : 0)),\n          ar: Number((_ref5 = (_p$AR = p.AR) !== null && _p$AR !== void 0 ? _p$AR : p.ar) !== null && _ref5 !== void 0 ? _ref5 : 0),\n          ap: Number((_ref6 = (_p$AP = p.AP) !== null && _p$AP !== void 0 ? _p$AP : p.ap) !== null && _ref6 !== void 0 ? _ref6 : Number((_ref7 = (_p$Spending3 = p.Spending) !== null && _p$Spending3 !== void 0 ? _p$Spending3 : p.spent) !== null && _ref7 !== void 0 ? _ref7 : 0)),\n          team: Number((_ref8 = (_p$Team = p.Team) !== null && _p$Team !== void 0 ? _p$Team : p.team) !== null && _ref8 !== void 0 ? _ref8 : 0),\n          deadline: p.EndDate || p.deadline || '',\n          departmentName: p.DepartmentName || p.departmentName || '',\n          transactions: p.transactions || []\n        };\n      });\n      setRawProjects(mappedProjects);\n      setSelectedOrg({\n        id: orgData.OrganizationID || orgId,\n        name: orgData.Name && orgData.Name.trim() ? orgData.Name : ((_organizations$find = organizations.find(o => o.id === orgId)) === null || _organizations$find === void 0 ? void 0 : _organizations$find.name) || '',\n        type: orgData.Type && orgData.Type.trim() ? orgData.Type : ((_organizations$find2 = organizations.find(o => o.id === orgId)) === null || _organizations$find2 === void 0 ? void 0 : _organizations$find2.type) || '',\n        description: orgData.Description && orgData.Description.trim() ? orgData.Description : ((_organizations$find3 = organizations.find(o => o.id === orgId)) === null || _organizations$find3 === void 0 ? void 0 : _organizations$find3.description) || '',\n        projects: mappedProjects,\n        color: ((_organizations$find4 = organizations.find(o => o.id === orgId)) === null || _organizations$find4 === void 0 ? void 0 : _organizations$find4.color) || '#3b82f6',\n        icon: ((_organizations$find5 = organizations.find(o => o.id === orgId)) === null || _organizations$find5 === void 0 ? void 0 : _organizations$find5.icon) || Building2\n      });\n      localStorage.setItem('selectedOrg', JSON.stringify(orgData));\n      setDepartments((deptRows || []).map(d => ({\n        id: d.DepartmentID,\n        name: d.Name\n      })));\n    } catch (err) {\n      console.error('Error selecting organization:', err);\n    }\n    setLoading(false);\n    navigate('/dashboard', {\n      state: {\n        selectedOrg: orgData,\n        organizationId: orgId,\n        userEmail\n      }\n    });\n  };\n\n  // --- Excel Upload & Direct Import ---\n  const handleFileUpload = async e => {\n    const file = e.target.files[0];\n    if (!file) return;\n    setUploadFileName(file.name);\n    let rows = [];\n    if (file.name.endsWith('.csv')) {\n      await new Promise((resolve, reject) => {\n        Papa.parse(file, {\n          header: true,\n          skipEmptyLines: true,\n          complete: results => {\n            rows = results.data;\n            resolve();\n          },\n          error: reject\n        });\n      });\n    } else {\n      const data = await new Promise(resolve => {\n        const reader = new FileReader();\n        reader.onload = evt => resolve(evt.target.result);\n        reader.readAsBinaryString(file);\n      });\n      const workbook = XLSX.read(data, {\n        type: 'binary'\n      });\n      const sheetName = workbook.SheetNames[0];\n      const sheet = workbook.Sheets[sheetName];\n      rows = XLSX.utils.sheet_to_json(sheet, {\n        defval: ''\n      });\n    }\n    const columnMap = {\n      OrganizationID: 'Org Id',\n      OrgName: 'Org name',\n      TxnID: 'TxnID',\n      TxnDate: 'TxnDate',\n      Category: 'Category',\n      Item: 'Item',\n      Type: 'Type',\n      Amount: 'Amount',\n      ProjectID: 'ProjectID',\n      ProjectName: 'ProjectName'\n    };\n\n    // --- Upload with orgId ---\n    await fetch(`${API_BASE}/import-transactions`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        rows,\n        uploaderEmail: userEmail,\n        fileName: file.name,\n        organizationId: (selectedOrg === null || selectedOrg === void 0 ? void 0 : selectedOrg.id) || organizationId,\n        // always tie to org\n        columnMap\n      })\n    });\n\n    // --- Fetch back data for this org only ---\n    const importedRes = await fetch(`${API_BASE}/imported-transactions?organizationId=${(selectedOrg === null || selectedOrg === void 0 ? void 0 : selectedOrg.id) || organizationId}`);\n    const imported = await importedRes.json();\n    setImportedRows(imported);\n\n    // Save with org-specific key\n    if (selectedOrg !== null && selectedOrg !== void 0 && selectedOrg.id || organizationId) {\n      localStorage.setItem(`importedRows_${(selectedOrg === null || selectedOrg === void 0 ? void 0 : selectedOrg.id) || organizationId}`, JSON.stringify(imported));\n    }\n    const projFinRes = await fetch(`${API_BASE}/project-financials?organizationId=${(selectedOrg === null || selectedOrg === void 0 ? void 0 : selectedOrg.id) || organizationId}`);\n    const projFin = await projFinRes.json();\n    setProjectsFromDB(Array.isArray(projFin) ? projFin : []);\n    if (selectedOrg !== null && selectedOrg !== void 0 && selectedOrg.id || organizationId) {\n      localStorage.setItem(`projectsFromDB_${(selectedOrg === null || selectedOrg === void 0 ? void 0 : selectedOrg.id) || organizationId}`, JSON.stringify(projFin));\n    }\n  };\n\n  // --- Use calculation logic for dashboard metrics ---\n  const dashboardMetrics = calculateDashboardMetrics(importedRows);\n\n  // --- Project selection handler ---\n  const handleProjectSelect = project => {\n    navigate(`/project/${project.id}`, {\n      state: {\n        project,\n        organization: selectedOrg\n      }\n    });\n  };\n\n  // --- Build projects with transactions from importedRows ---\n  useEffect(() => {\n    // Group transactions by ProjectID\n    const txByProject = {};\n    const orgLevelTxs = [];\n    importedRows.forEach(tx => {\n      const pid = tx.ProjectID || tx.ProjectId || tx.projectId || '';\n      if (pid) {\n        if (!txByProject[pid]) txByProject[pid] = [];\n        txByProject[pid].push(tx);\n      } else {\n        // No ProjectID: organization-level transaction\n        orgLevelTxs.push(tx);\n      }\n    });\n\n    // Map projectsFromDB with transactions, budget, spent, etc.\n    const normalizedProjects = (projectsFromDB || []).map(p => {\n      var _ref9, _p$Budget3, _ref0, _p$Spending4, _ref1, _p$Budget4, _ref10, _p$Spending5, _ref11, _p$AR2, _ref12, _p$AP2, _ref13, _p$Spending6, _ref14, _p$Team2;\n      return {\n        id: p.ProjectID || p.ProjectId || p.id,\n        name: p.ProjectName || p.Name || p.name || '',\n        status: (p.Status || p.status || '').toString(),\n        budget: Number((_ref9 = (_p$Budget3 = p.Budget) !== null && _p$Budget3 !== void 0 ? _p$Budget3 : p.budget) !== null && _ref9 !== void 0 ? _ref9 : 0),\n        spent: Number((_ref0 = (_p$Spending4 = p.Spending) !== null && _p$Spending4 !== void 0 ? _p$Spending4 : p.spent) !== null && _ref0 !== void 0 ? _ref0 : 0),\n        profit: Number(p.Profit !== undefined ? p.Profit : Number((_ref1 = (_p$Budget4 = p.Budget) !== null && _p$Budget4 !== void 0 ? _p$Budget4 : p.budget) !== null && _ref1 !== void 0 ? _ref1 : 0) - Number((_ref10 = (_p$Spending5 = p.Spending) !== null && _p$Spending5 !== void 0 ? _p$Spending5 : p.spent) !== null && _ref10 !== void 0 ? _ref10 : 0)),\n        ar: Number((_ref11 = (_p$AR2 = p.AR) !== null && _p$AR2 !== void 0 ? _p$AR2 : p.ar) !== null && _ref11 !== void 0 ? _ref11 : 0),\n        ap: Number((_ref12 = (_p$AP2 = p.AP) !== null && _p$AP2 !== void 0 ? _p$AP2 : p.ap) !== null && _ref12 !== void 0 ? _ref12 : Number((_ref13 = (_p$Spending6 = p.Spending) !== null && _p$Spending6 !== void 0 ? _p$Spending6 : p.spent) !== null && _ref13 !== void 0 ? _ref13 : 0)),\n        team: Number((_ref14 = (_p$Team2 = p.Team) !== null && _p$Team2 !== void 0 ? _p$Team2 : p.team) !== null && _ref14 !== void 0 ? _ref14 : 0),\n        deadline: p.EndDate || p.deadline || '',\n        departmentName: p.DepartmentName || p.departmentName || '',\n        transactions: txByProject[p.ProjectID || p.ProjectId || p.id] || []\n      };\n    });\n\n    // Pass orgLevelTxs to CompanyDashboard as organization.transactions\n    setRawProjects(normalizedProjects);\n    setSelectedOrg(prev => ({\n      ...(prev || {}),\n      transactions: orgLevelTxs // <-- add org-level transactions here\n    }));\n  }, [importedRows, projectsFromDB]);\n\n  // --- Restore org-specific data on login or org change ---\n  useEffect(() => {\n    if (organizationId) {\n      // Restore importedRows for this org only\n      const savedRows = localStorage.getItem(`importedRows_${organizationId}`);\n      setImportedRows(savedRows ? JSON.parse(savedRows) : []);\n      // Restore selectedOrg for this org only\n      const savedOrg = localStorage.getItem(`selectedOrg_${organizationId}`);\n      setSelectedOrg(savedOrg ? JSON.parse(savedOrg) : null);\n      // Restore projectsFromDB for this org only\n      const savedProjects = localStorage.getItem(`projectsFromDB_${organizationId}`);\n      setProjectsFromDB(savedProjects ? JSON.parse(savedProjects) : []);\n    }\n  }, [organizationId]);\n\n  // --- Save org-specific data whenever it changes ---\n  useEffect(() => {\n    if (organizationId) {\n      localStorage.setItem(`importedRows_${organizationId}`, JSON.stringify(importedRows));\n    }\n  }, [importedRows, organizationId]);\n  useEffect(() => {\n    if (organizationId) {\n      localStorage.setItem(`selectedOrg_${organizationId}`, JSON.stringify(selectedOrg));\n    }\n  }, [selectedOrg, organizationId]);\n  useEffect(() => {\n    if (organizationId) {\n      localStorage.setItem(`projectsFromDB_${organizationId}`, JSON.stringify(projectsFromDB));\n    }\n  }, [projectsFromDB, organizationId]);\n\n  // --- Clear org-specific localStorage and state on org change or login ---\n  useEffect(() => {\n    if (organizationId) {\n      // Remove only org-specific keys\n      localStorage.removeItem(`importedRows_${organizationId}`);\n      localStorage.removeItem(`selectedOrg_${organizationId}`);\n      localStorage.removeItem(`projectsFromDB_${organizationId}`);\n      setImportedRows([]);\n      setSelectedOrg(null);\n      setProjectsFromDB([]);\n      setRawProjects([]);\n      setDepartments([]);\n      setSelectedDept('all');\n      setSelectedProject(null);\n      setView('organizations');\n    }\n  }, [organizationId]);\n\n  // --- UI ---\n  if (location.pathname === '/dashboard') {\n    return /*#__PURE__*/_jsxDEV(CompanyDashboard, {\n      organization: selectedOrg,\n      selectedDept: selectedDept,\n      onDeptChange: setSelectedDept,\n      onProjectSelect: handleProjectSelect,\n      onAddProject: setShowNewProjectForm,\n      onFileUpload: handleFileUpload,\n      onBack: () => navigate('/'),\n      projects: rawProjects // <-- FIXED: use normalized projects with transactions\n      ,\n      totals: dashboardMetrics\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 7\n    }, this);\n  }\n  if (location.pathname.startsWith('/project/')) {\n    // This will be handled by ProjectDashboardWrapper in App.jsx\n    return null;\n  }\n\n  // Default: org selector\n  return /*#__PURE__*/_jsxDEV(OrganizationSelector, {\n    organizations: organizations,\n    organizationId: organizationId,\n    onSelect: handleOrgSelect\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 420,\n    columnNumber: 5\n  }, this);\n};\n_s(Dashboard, \"uDRuDGPWO2kz3YbVwqKaeSakW7c=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c3 = Dashboard;\nexport default Dashboard;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"DashboardCard\");\n$RefreshReg$(_c2, \"BreakdownModal\");\n$RefreshReg$(_c3, \"Dashboard\");","map":{"version":3,"names":["React","useState","useEffect","Building2","Code","useNavigate","useLocation","OrganizationSelector","CompanyDashboard","ProjectDashboard","Header","XLSX","Papa","calculateDashboardMetrics","getBreakdownByCategory","jsxDEV","_jsxDEV","API_BASE","dbFields","DashboardCard","title","value","color","onClick","style","flex","background","borderRadius","padding","textAlign","boxShadow","minWidth","fontSize","cursor","children","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","fontWeight","Number","toLocaleString","_c","BreakdownModal","type","breakdown","onClose","position","top","left","width","height","display","alignItems","justifyContent","zIndex","charAt","toUpperCase","slice","marginTop","Object","entries","map","cat","amt","_c2","Dashboard","isLoggedIn","onLogout","_s","_location$state","_location$state2","location","navigate","userEmail","state","organizationId","view","setView","localStorage","getItem","selectedOrg","setSelectedOrg","selectedDept","setSelectedDept","selectedProject","setSelectedProject","organizations","setOrganizations","rawProjects","setRawProjects","departments","setDepartments","showNewProjectForm","setShowNewProjectForm","loading","setLoading","excelData","setExcelData","excelColumns","setExcelColumns","columnMap","setColumnMap","uploadFileName","setUploadFileName","importedRows","setImportedRows","projectsFromDB","setProjectsFromDB","step","setStep","modalView","setModalView","String","id","loadOrgs","res","fetch","data","json","mapped","o","OrganizationID","name","Name","Type","description","Description","icon","err","console","error","handleOrgSelect","orgId","_organizations$find","_organizations$find2","_organizations$find3","_organizations$find4","_organizations$find5","orgRes","orgData","projRes","projRows","deptRes","deptRows","importedRes","imported","setItem","JSON","stringify","projFinRes","projFin","Array","isArray","mappedProjects","p","_ref","_p$Budget","_ref2","_p$Spending","_ref3","_p$Budget2","_ref4","_p$Spending2","_ref5","_p$AR","_ref6","_p$AP","_ref7","_p$Spending3","_ref8","_p$Team","ProjectID","ProjectId","ProjectName","status","Status","toString","budget","Budget","spent","Spending","profit","Profit","undefined","ar","AR","ap","AP","team","Team","deadline","EndDate","departmentName","DepartmentName","transactions","trim","find","projects","d","DepartmentID","handleFileUpload","e","file","target","files","rows","endsWith","Promise","resolve","reject","parse","header","skipEmptyLines","complete","results","reader","FileReader","onload","evt","result","readAsBinaryString","workbook","read","sheetName","SheetNames","sheet","Sheets","utils","sheet_to_json","defval","OrgName","TxnID","TxnDate","Category","Item","Amount","method","headers","body","uploaderEmail","dashboardMetrics","handleProjectSelect","project","organization","txByProject","orgLevelTxs","forEach","tx","pid","projectId","push","normalizedProjects","_ref9","_p$Budget3","_ref0","_p$Spending4","_ref1","_p$Budget4","_ref10","_p$Spending5","_ref11","_p$AR2","_ref12","_p$AP2","_ref13","_p$Spending6","_ref14","_p$Team2","prev","savedRows","savedOrg","savedProjects","removeItem","pathname","onDeptChange","onProjectSelect","onAddProject","onFileUpload","onBack","totals","startsWith","onSelect","_c3","$RefreshReg$"],"sources":["C:/Users/VivekReddyMeka/Desktop/Accounts_Management/src/Components/Dashboard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Building2, Code } from 'lucide-react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport OrganizationSelector from './OrganizationSelector';\r\nimport CompanyDashboard from './CompanyDashboard';\r\nimport ProjectDashboard from './ProjectDashboard';\r\nimport Header from './Header';\r\nimport '../Styles/Dashboard.css';\r\nimport * as XLSX from 'xlsx';\r\nimport Papa from 'papaparse';\r\nimport { calculateDashboardMetrics, getBreakdownByCategory } from '../utils/Calculations';\r\n\r\nconst API_BASE = 'http://localhost:3001';\r\nconst dbFields = [\r\n  'OrganizationID', 'OrgName', 'TxnID', 'TxnDate', 'Category', 'Item', 'Type', 'Amount', 'ProjectID', 'ProjectName'\r\n];\r\n\r\nconst DashboardCard = ({ title, value, color, onClick }) => (\r\n  <div\r\n    style={{\r\n      flex: '1 1 0',\r\n      background: color,\r\n      color: '#fff',\r\n      borderRadius: 12,\r\n      padding: '32px 24px',\r\n      textAlign: 'center',\r\n      boxShadow: '0 2px 8px #0002',\r\n      minWidth: 200,\r\n      fontSize: 20,\r\n      cursor: onClick ? 'pointer' : 'default'\r\n    }}\r\n    onClick={onClick}\r\n  >\r\n    <div style={{ fontSize: 18, marginBottom: 8 }}>{title}</div>\r\n    <div style={{ fontSize: 32, fontWeight: 700 }}>\r\n      {title === 'Net Margin (%)'\r\n        ? `${value}%`\r\n        : `₹${Number(value).toLocaleString()}`}\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst BreakdownModal = ({ type, breakdown, onClose }) => (\r\n  <div style={{\r\n    position: 'fixed', top: 0, left: 0, width: '100vw', height: '100vh',\r\n    background: '#0007', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 9999\r\n  }}>\r\n    <div style={{ background: '#fff', borderRadius: 10, padding: 32, minWidth: 400 }}>\r\n      <h3>{type.charAt(0).toUpperCase() + type.slice(1)} Breakdown by Category</h3>\r\n      <table style={{ width: '100%', marginTop: 16 }}>\r\n        <thead>\r\n          <tr>\r\n            <th>Category</th>\r\n            <th>Amount</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {Object.entries(breakdown).map(([cat, amt]) => (\r\n            <tr key={cat}>\r\n              <td>{cat}</td>\r\n              <td>₹{amt.toLocaleString()}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n      <button style={{ marginTop: 24 }} onClick={onClose}>Close</button>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst Dashboard = ({ isLoggedIn, onLogout }) => {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const userEmail = location.state?.userEmail || '';\r\n  const organizationId = location.state?.organizationId || null;\r\n\r\n  // --- State declarations ---\r\n  const [view, setView] = useState(() => localStorage.getItem('dashboardView') || 'organizations');\r\n  const [selectedOrg, setSelectedOrg] = useState(null);\r\n  const [selectedDept, setSelectedDept] = useState('all');\r\n  const [selectedProject, setSelectedProject] = useState(null);\r\n  const [organizations, setOrganizations] = useState([]);\r\n  const [rawProjects, setRawProjects] = useState([]);\r\n  const [departments, setDepartments] = useState([]);\r\n  const [showNewProjectForm, setShowNewProjectForm] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // --- Excel/DB Import states ---\r\n  const [excelData, setExcelData] = useState([]);\r\n  const [excelColumns, setExcelColumns] = useState([]);\r\n  const [columnMap, setColumnMap] = useState({});\r\n  const [uploadFileName, setUploadFileName] = useState('');\r\n  const [importedRows, setImportedRows] = useState([]);\r\n  const [projectsFromDB, setProjectsFromDB] = useState([]);\r\n  const [step, setStep] = useState(1);\r\n\r\n  // --- Modal state for breakdown ---\r\n  const [modalView, setModalView] = useState(null); // 'ar', 'ap', 'profit', 'loss', null\r\n\r\n  // --- Prevent access to other organizations by direct URL ---\r\n  useEffect(() => {\r\n    if (selectedOrg && String(selectedOrg.id) !== String(organizationId)) {\r\n      setView('organizations');\r\n      setSelectedOrg(null);\r\n    }\r\n  }, [selectedOrg, organizationId]);\r\n\r\n  // --- Load organizations ---\r\n  useEffect(() => {\r\n    const loadOrgs = async () => {\r\n      try {\r\n        const res = await fetch(`${API_BASE}/organizations`);\r\n        const data = await res.json();\r\n        const mapped = data.map(o => ({\r\n          id: o.OrganizationID,\r\n          name: o.Name,\r\n          type: o.Type || '',\r\n          description: o.Description || '',\r\n          // Use icon and color from DB, fallback if missing\r\n          icon: o.icon === 'Code' ? Code : Building2,\r\n          color: o.color || '#3b82f6'\r\n        }));\r\n        setOrganizations(mapped);\r\n      } catch (err) {\r\n        console.error('Error loading organizations:', err);\r\n      }\r\n    };\r\n    loadOrgs();\r\n  }, []);\r\n\r\n  // --- Organization selection ---\r\n  const handleOrgSelect = async (orgId) => {\r\n    setLoading(true);\r\n    setSelectedDept('all');\r\n    setSelectedProject(null);\r\n    setView('dashboard');\r\n    setStep(1);\r\n\r\n    // --- Clear previous organization data ---\r\n    // setImportedRows([]);\r\n    // setProjectsFromDB([]);\r\n    // localStorage.removeItem('importedRows');\r\n    // localStorage.removeItem('selectedOrg');\r\n\r\n    try {\r\n      // Fetch organization, projects, departments for the selected org\r\n      const orgRes = await fetch(`${API_BASE}/organizations/${orgId}`);\r\n      const orgData = await orgRes.json();\r\n\r\n      const projRes = await fetch(`${API_BASE}/projects?organizationId=${orgId}`);\r\n      const projRows = await projRes.json();\r\n\r\n      const deptRes = await fetch(`${API_BASE}/departments?organizationId=${orgId}`);\r\n      const deptRows = await deptRes.json();\r\n\r\n      // --- Fetch transactions for this organization ---\r\n      const importedRes = await fetch(`${API_BASE}/imported-transactions?organizationId=${orgId}`);\r\n      const imported = await importedRes.json();\r\n      setImportedRows(imported);\r\n      localStorage.setItem('importedRows', JSON.stringify(imported));\r\n\r\n      // --- Fetch project financials for this organization ---\r\n      const projFinRes = await fetch(`${API_BASE}/project-financials?organizationId=${orgId}`);\r\n      const projFin = await projFinRes.json();\r\n      setProjectsFromDB(Array.isArray(projFin) ? projFin : []);\r\n\r\n      const mappedProjects = (projRows || []).map(p => ({\r\n        id: p.ProjectID || p.ProjectId || p.id,\r\n        name: p.ProjectName || p.Name || p.name || '',\r\n        status: (p.Status || p.status || '').toString(),\r\n        budget: Number(p.Budget ?? p.budget ?? 0),\r\n        spent: Number(p.Spending ?? p.spent ?? 0),\r\n        profit: Number(\r\n          p.Profit !== undefined\r\n            ? p.Profit\r\n            : (Number(p.Budget ?? p.budget ?? 0) - Number(p.Spending ?? p.spent ?? 0))\r\n        ),\r\n        ar: Number(p.AR ?? p.ar ?? 0),\r\n        ap: Number(p.AP ?? p.ap ?? Number(p.Spending ?? p.spent ?? 0)),\r\n        team: Number(p.Team ?? p.team ?? 0),\r\n        deadline: p.EndDate || p.deadline || '',\r\n        departmentName: p.DepartmentName || p.departmentName || '',\r\n        transactions: p.transactions || []\r\n      }));\r\n\r\n      setRawProjects(mappedProjects);\r\n      setSelectedOrg({\r\n        id: orgData.OrganizationID || orgId,\r\n        name: orgData.Name && orgData.Name.trim() ? orgData.Name : (organizations.find(o => o.id === orgId)?.name || ''),\r\n        type: orgData.Type && orgData.Type.trim() ? orgData.Type : (organizations.find(o => o.id === orgId)?.type || ''),\r\n        description: orgData.Description && orgData.Description.trim() ? orgData.Description : (organizations.find(o => o.id === orgId)?.description || ''),\r\n        projects: mappedProjects,\r\n        color: organizations.find(o => o.id === orgId)?.color || '#3b82f6',\r\n        icon: organizations.find(o => o.id === orgId)?.icon || Building2\r\n      });\r\n      localStorage.setItem('selectedOrg', JSON.stringify(orgData));\r\n\r\n      setDepartments((deptRows || []).map(d => ({ id: d.DepartmentID, name: d.Name })));\r\n    } catch (err) {\r\n      console.error('Error selecting organization:', err);\r\n    }\r\n    setLoading(false);\r\n    navigate('/dashboard', { state: { selectedOrg: orgData, organizationId: orgId, userEmail } });\r\n  };\r\n\r\n  // --- Excel Upload & Direct Import ---\r\n  const handleFileUpload = async (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n    setUploadFileName(file.name);\r\n\r\n    let rows = [];\r\n    if (file.name.endsWith('.csv')) {\r\n      await new Promise((resolve, reject) => {\r\n        Papa.parse(file, {\r\n          header: true,\r\n          skipEmptyLines: true,\r\n          complete: (results) => {\r\n            rows = results.data;\r\n            resolve();\r\n          },\r\n          error: reject\r\n        });\r\n      });\r\n    } else {\r\n      const data = await new Promise((resolve) => {\r\n        const reader = new FileReader();\r\n        reader.onload = (evt) => resolve(evt.target.result);\r\n        reader.readAsBinaryString(file);\r\n      });\r\n      const workbook = XLSX.read(data, { type: 'binary' });\r\n      const sheetName = workbook.SheetNames[0];\r\n      const sheet = workbook.Sheets[sheetName];\r\n      rows = XLSX.utils.sheet_to_json(sheet, { defval: '' });\r\n    }\r\n\r\n    const columnMap = {\r\n      OrganizationID: 'Org Id',\r\n      OrgName: 'Org name',\r\n      TxnID: 'TxnID',\r\n      TxnDate: 'TxnDate',\r\n      Category: 'Category',\r\n      Item: 'Item',\r\n      Type: 'Type',\r\n      Amount: 'Amount',\r\n      ProjectID: 'ProjectID',\r\n      ProjectName: 'ProjectName'\r\n    };\r\n\r\n    // --- Upload with orgId ---\r\n    await fetch(`${API_BASE}/import-transactions`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({\r\n        rows,\r\n        uploaderEmail: userEmail,\r\n        fileName: file.name,\r\n        organizationId: selectedOrg?.id || organizationId, // always tie to org\r\n        columnMap\r\n      })\r\n    });\r\n\r\n    // --- Fetch back data for this org only ---\r\n    const importedRes = await fetch(\r\n      `${API_BASE}/imported-transactions?organizationId=${selectedOrg?.id || organizationId}`\r\n    );\r\n    const imported = await importedRes.json();\r\n    setImportedRows(imported);\r\n\r\n    // Save with org-specific key\r\n    if (selectedOrg?.id || organizationId) {\r\n      localStorage.setItem(\r\n        `importedRows_${selectedOrg?.id || organizationId}`,\r\n        JSON.stringify(imported)\r\n      );\r\n    }\r\n\r\n    const projFinRes = await fetch(\r\n      `${API_BASE}/project-financials?organizationId=${selectedOrg?.id || organizationId}`\r\n    );\r\n    const projFin = await projFinRes.json();\r\n    setProjectsFromDB(Array.isArray(projFin) ? projFin : []);\r\n\r\n    if (selectedOrg?.id || organizationId) {\r\n      localStorage.setItem(\r\n        `projectsFromDB_${selectedOrg?.id || organizationId}`,\r\n        JSON.stringify(projFin)\r\n      );\r\n    }\r\n  };\r\n\r\n  // --- Use calculation logic for dashboard metrics ---\r\n  const dashboardMetrics = calculateDashboardMetrics(importedRows);\r\n\r\n  // --- Project selection handler ---\r\n  const handleProjectSelect = (project) => {\r\n    navigate(`/project/${project.id}`, { state: { project, organization: selectedOrg } });\r\n  };\r\n\r\n  // --- Build projects with transactions from importedRows ---\r\n  useEffect(() => {\r\n    // Group transactions by ProjectID\r\n    const txByProject = {};\r\n    const orgLevelTxs = [];\r\n    importedRows.forEach(tx => {\r\n      const pid = tx.ProjectID || tx.ProjectId || tx.projectId || '';\r\n      if (pid) {\r\n        if (!txByProject[pid]) txByProject[pid] = [];\r\n        txByProject[pid].push(tx);\r\n      } else {\r\n        // No ProjectID: organization-level transaction\r\n        orgLevelTxs.push(tx);\r\n      }\r\n    });\r\n\r\n    // Map projectsFromDB with transactions, budget, spent, etc.\r\n    const normalizedProjects = (projectsFromDB || []).map(p => ({\r\n      id: p.ProjectID || p.ProjectId || p.id,\r\n      name: p.ProjectName || p.Name || p.name || '',\r\n      status: (p.Status || p.status || '').toString(),\r\n      budget: Number(p.Budget ?? p.budget ?? 0),\r\n      spent: Number(p.Spending ?? p.spent ?? 0),\r\n      profit: Number(\r\n        p.Profit !== undefined\r\n          ? p.Profit\r\n          : (Number(p.Budget ?? p.budget ?? 0) - Number(p.Spending ?? p.spent ?? 0))\r\n      ),\r\n      ar: Number(p.AR ?? p.ar ?? 0),\r\n      ap: Number(p.AP ?? p.ap ?? Number(p.Spending ?? p.spent ?? 0)),\r\n      team: Number(p.Team ?? p.team ?? 0),\r\n      deadline: p.EndDate || p.deadline || '',\r\n      departmentName: p.DepartmentName || p.departmentName || '',\r\n      transactions: txByProject[p.ProjectID || p.ProjectId || p.id] || []\r\n    }));\r\n\r\n    // Pass orgLevelTxs to CompanyDashboard as organization.transactions\r\n    setRawProjects(normalizedProjects);\r\n    setSelectedOrg(prev => ({\r\n      ...(prev || {}),\r\n      transactions: orgLevelTxs // <-- add org-level transactions here\r\n    }));\r\n  }, [importedRows, projectsFromDB]);\r\n\r\n  // --- Restore org-specific data on login or org change ---\r\n  useEffect(() => {\r\n    if (organizationId) {\r\n      // Restore importedRows for this org only\r\n      const savedRows = localStorage.getItem(`importedRows_${organizationId}`);\r\n      setImportedRows(savedRows ? JSON.parse(savedRows) : []);\r\n      // Restore selectedOrg for this org only\r\n      const savedOrg = localStorage.getItem(`selectedOrg_${organizationId}`);\r\n      setSelectedOrg(savedOrg ? JSON.parse(savedOrg) : null);\r\n      // Restore projectsFromDB for this org only\r\n      const savedProjects = localStorage.getItem(`projectsFromDB_${organizationId}`);\r\n      setProjectsFromDB(savedProjects ? JSON.parse(savedProjects) : []);\r\n    }\r\n  }, [organizationId]);\r\n\r\n  // --- Save org-specific data whenever it changes ---\r\n  useEffect(() => {\r\n    if (organizationId) {\r\n      localStorage.setItem(`importedRows_${organizationId}`, JSON.stringify(importedRows));\r\n    }\r\n  }, [importedRows, organizationId]);\r\n\r\n  useEffect(() => {\r\n    if (organizationId) {\r\n      localStorage.setItem(`selectedOrg_${organizationId}`, JSON.stringify(selectedOrg));\r\n    }\r\n  }, [selectedOrg, organizationId]);\r\n\r\n  useEffect(() => {\r\n    if (organizationId) {\r\n      localStorage.setItem(`projectsFromDB_${organizationId}`, JSON.stringify(projectsFromDB));\r\n    }\r\n  }, [projectsFromDB, organizationId]);\r\n\r\n  // --- Clear org-specific localStorage and state on org change or login ---\r\n  useEffect(() => {\r\n    if (organizationId) {\r\n      // Remove only org-specific keys\r\n      localStorage.removeItem(`importedRows_${organizationId}`);\r\n      localStorage.removeItem(`selectedOrg_${organizationId}`);\r\n      localStorage.removeItem(`projectsFromDB_${organizationId}`);\r\n      setImportedRows([]);\r\n      setSelectedOrg(null);\r\n      setProjectsFromDB([]);\r\n      setRawProjects([]);\r\n      setDepartments([]);\r\n      setSelectedDept('all');\r\n      setSelectedProject(null);\r\n      setView('organizations');\r\n    }\r\n  }, [organizationId]);\r\n\r\n  // --- UI ---\r\n  if (location.pathname === '/dashboard') {\r\n    return (\r\n      <CompanyDashboard\r\n        organization={selectedOrg}\r\n        selectedDept={selectedDept}\r\n        onDeptChange={setSelectedDept}\r\n        onProjectSelect={handleProjectSelect}\r\n        onAddProject={setShowNewProjectForm}\r\n        onFileUpload={handleFileUpload}\r\n        onBack={() => navigate('/')}\r\n        projects={rawProjects} // <-- FIXED: use normalized projects with transactions\r\n        totals={dashboardMetrics}\r\n      />\r\n    );\r\n  }\r\n\r\n  if (location.pathname.startsWith('/project/')) {\r\n    // This will be handled by ProjectDashboardWrapper in App.jsx\r\n    return null;\r\n  }\r\n\r\n  // Default: org selector\r\n  return (\r\n    <OrganizationSelector\r\n      organizations={organizations}\r\n      organizationId={organizationId}\r\n      onSelect={handleOrgSelect}\r\n    />\r\n  );\r\n};\r\n\r\nexport default Dashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}