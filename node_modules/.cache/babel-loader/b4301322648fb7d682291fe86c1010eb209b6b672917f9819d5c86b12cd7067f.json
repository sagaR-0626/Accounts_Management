{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\VivekReddyMeka\\\\Desktop\\\\Accounts_Management\\\\src\\\\Components\\\\Dashboard.jsx\",\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { Building2, Code } from 'lucide-react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport OrganizationSelector from './OrganizationSelector';\nimport CompanyDashboard from './CompanyDashboard';\nimport ProjectDashboard from './ProjectDashboard';\nimport Header from './Header';\nimport '../Styles/Dashboard.css'; // Import the CSS file\nimport * as XLSX from 'xlsx'; // Add at top\nimport { Bar, Pie } from 'react-chartjs-2';\nimport { Chart, ArcElement, BarElement, CategoryScale, LinearScale, Tooltip, Legend } from 'chart.js';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nChart.register(ArcElement, BarElement, CategoryScale, LinearScale, Tooltip, Legend);\nconst API_BASE = 'http://localhost:3001'; // adjust if your server runs elsewhere\n\n// Main Dashboard Component (now loads data from DB via API)\nconst OrganizationDashboard = ({\n  isLoggedIn,\n  onLogout\n}) => {\n  _s2();\n  var _location$state,\n    _location$state2,\n    _s = $RefreshSig$();\n  const location = useLocation();\n  const userEmail = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.userEmail) || '';\n  const organizationId = ((_location$state2 = location.state) === null || _location$state2 === void 0 ? void 0 : _location$state2.organizationId) || null;\n\n  // Load initial view from localStorage, fallback to 'organizations'\n  const [view, setView] = useState(() => localStorage.getItem('dashboardView') || 'organizations');\n  const [selectedOrg, setSelectedOrg] = useState(() => {\n    const org = localStorage.getItem('selectedOrg');\n    return org ? JSON.parse(org) : null;\n  });\n  const [selectedDept, setSelectedDept] = useState(() => localStorage.getItem('selectedDept') || 'all');\n  const [selectedProject, setSelectedProject] = useState(() => {\n    const proj = localStorage.getItem('selectedProject');\n    return proj ? JSON.parse(proj) : null;\n  });\n  const [organizations, setOrganizations] = useState([]);\n  const [rawProjects, setRawProjects] = useState([]); // raw rows from API (contain DepartmentName etc.)\n  const [departments, setDepartments] = useState([]);\n  const [totals, setTotals] = useState({\n    budget: 0,\n    spent: 0,\n    profit: 0,\n    ar: 0,\n    ap: 0,\n    team: 0\n  });\n  const [showNewProjectForm, setShowNewProjectForm] = useState(false);\n  const [uploadedData, setUploadedData] = useState([]);\n  const [uploadError, setUploadError] = useState('');\n  const [uploadFileName, setUploadFileName] = useState('');\n  const [showAmountPopup, setShowAmountPopup] = useState(false);\n  const [dateFilter, setDateFilter] = useState({\n    from: '',\n    to: ''\n  });\n  const [showUploadedPreview, setShowUploadedPreview] = useState(false);\n  const navigate = useNavigate(); // Add this line\n\n  // Save view/page state to localStorage whenever it changes\n  useEffect(() => {\n    localStorage.setItem('dashboardView', view);\n  }, [view]);\n  useEffect(() => {\n    localStorage.setItem('selectedOrg', JSON.stringify(selectedOrg));\n  }, [selectedOrg]);\n  useEffect(() => {\n    localStorage.setItem('selectedDept', selectedDept);\n  }, [selectedDept]);\n  useEffect(() => {\n    localStorage.setItem('selectedProject', JSON.stringify(selectedProject));\n  }, [selectedProject]);\n  useEffect(() => {\n    // load organizations list\n    const loadOrgs = async () => {\n      try {\n        const res = await fetch(`${API_BASE}/organizations`);\n        const data = await res.json();\n        const mapped = data.map(o => ({\n          id: o.OrganizationID,\n          name: o.Name,\n          type: o.Type || '',\n          description: o.Description || '',\n          // choose icons/colors by name/type to keep existing UI consistent\n          icon: o.Name && o.Name.toLowerCase().includes('collabridge') ? Code : Building2,\n          color: o.Name && o.Name.toLowerCase().includes('la tierra') ? '#10b981' : '#3b82f6'\n        }));\n        setOrganizations(mapped);\n      } catch (err) {\n        console.error('Error loading organizations:', err);\n      }\n    };\n    loadOrgs();\n  }, []);\n\n  // Auto-select organization based on email domain\n  // useEffect(() => {\n  //   if (!userEmail || !organizations.length) return;\n\n  //   let orgToSelect = null;\n  //   if (userEmail.toLowerCase().endsWith('@collabridge.com')) {\n  //     orgToSelect = organizations.find(o => o.name.toLowerCase().includes('collabridge'));\n  //   } else if (userEmail.toLowerCase().endsWith('@latierra.com')) {\n  //     orgToSelect = organizations.find(o => o.name.toLowerCase().includes('la tierra') || o.name.toLowerCase().includes('buildcraft'));\n  //   }\n\n  //   if (orgToSelect && (!selectedOrg || selectedOrg.id !== orgToSelect.id)) {\n  //     handleOrgSelect(orgToSelect.id);\n  //   }\n  // }, [userEmail, organizations]);\n\n  // Auto-select organization if organizationId is present\n  useEffect(() => {\n    if (!organizationId || !organizations.length) return;\n    const orgToSelect = organizations.find(o => o.id === Number(organizationId));\n    if (orgToSelect && (!selectedOrg || selectedOrg.id !== orgToSelect.id)) {\n      handleOrgSelect(orgToSelect.id);\n    }\n  }, [organizationId, organizations]);\n  const handleOrgSelect = async orgId => {\n    setSelectedDept('all');\n    setSelectedProject(null);\n    setView('dashboard');\n    try {\n      var _organizations$find, _organizations$find2;\n      // get organization details\n      const orgRes = await fetch(`${API_BASE}/organizations/${orgId}`);\n      const orgData = await orgRes.json();\n\n      // projects for organization\n      const projRes = await fetch(`${API_BASE}/projects?organizationId=${orgId}`);\n      const projRows = await projRes.json();\n\n      // departments list for filters\n      const deptRes = await fetch(`${API_BASE}/departments?organizationId=${orgId}`);\n      const deptRows = await deptRes.json();\n\n      // map project rows to the shape used by UI (keep DepartmentName for filtering)\n      const mappedProjects = (projRows || []).map(p => {\n        const budget = Number(p.Budget || 0);\n        const spent = Number(p.Spending || 0);\n        const profit = Number(p.Profit !== undefined ? p.Profit : budget - spent);\n        return {\n          id: p.ProjectID || p.ProjectId || p.id,\n          name: p.ProjectName || p.Name || '',\n          status: (p.Status || '').toString(),\n          budget,\n          spent,\n          profit,\n          ar: Number(p.AR || 0),\n          // fallback 0, server may not supply project-level AR\n          ap: Number(p.AP !== undefined ? p.AP : spent),\n          // fallback to spent as payable approximation\n          team: Number(p.Team || 0),\n          // not present in DB seed -> 0 unless backend supplies it\n          deadline: p.EndDate || p.deadline || '',\n          departmentName: p.DepartmentName || ''\n        };\n      });\n      setRawProjects(mappedProjects);\n      // set selectedOrg with API info + mapped projects\n      setSelectedOrg({\n        id: orgData.OrganizationID || orgId,\n        name: orgData.Name || '',\n        type: orgData.Type || '',\n        description: orgData.Description || '',\n        projects: mappedProjects,\n        color: ((_organizations$find = organizations.find(o => o.id === orgId)) === null || _organizations$find === void 0 ? void 0 : _organizations$find.color) || '#3b82f6',\n        icon: ((_organizations$find2 = organizations.find(o => o.id === orgId)) === null || _organizations$find2 === void 0 ? void 0 : _organizations$find2.icon) || Building2\n      });\n\n      // normalize departments\n      setDepartments((deptRows || []).map(d => ({\n        id: d.DepartmentID,\n        name: d.Name\n      })));\n\n      // totals: try to use organization dashboard endpoint\n      try {\n        const dashRes = await fetch(`${API_BASE}/organizations/${orgId}/dashboard`);\n        if (dashRes.ok) {\n          const dash = await dashRes.json();\n          setTotals({\n            budget: Number(dash.totalBudget || 0),\n            spent: Number(dash.totalSpending || 0),\n            profit: Number(dash.totalBudget || 0) - Number(dash.totalSpending || 0),\n            ar: Number(dash.totalAR || 0),\n            ap: Number(dash.totalAP || 0),\n            team: mappedProjects.reduce((s, p) => s + (p.team || 0), 0)\n          });\n        } else {\n          // fallback compute from projects\n          computeTotalsFromProjects(mappedProjects);\n        }\n      } catch (err) {\n        computeTotalsFromProjects(mappedProjects);\n      }\n    } catch (err) {\n      console.error('Error selecting organization:', err);\n    }\n  };\n  const computeTotalsFromProjects = projects => {\n    const t = projects.reduce((acc, project) => ({\n      budget: acc.budget + (project.budget || 0),\n      spent: acc.spent + (project.spent || 0),\n      profit: acc.profit + (project.profit || 0),\n      ar: acc.ar + (project.ar || 0),\n      ap: acc.ap + (project.ap || 0),\n      team: acc.team + (project.team || 0)\n    }), {\n      budget: 0,\n      spent: 0,\n      profit: 0,\n      ar: 0,\n      ap: 0,\n      team: 0\n    });\n    setTotals(t);\n  };\n  const handleProjectSelect = project => {\n    // project could be raw project object from projects list\n    setSelectedProject(project);\n    setView('project');\n  };\n  const handleBack = () => {\n    if (view === 'project') {\n      setView('dashboard');\n      setSelectedProject(null);\n    } else {\n      setView('organizations');\n      setSelectedOrg(null);\n      setSelectedDept('all');\n      setRawProjects([]);\n      setDepartments([]);\n      setTotals({\n        budget: 0,\n        spent: 0,\n        profit: 0,\n        ar: 0,\n        ap: 0,\n        team: 0\n      });\n    }\n  };\n  const getFilteredProjects = () => {\n    if (!selectedOrg) return [];\n    if (selectedOrg.id === 1 && selectedOrg.projects) {\n      // legacy behavior: org 1 is \"software\" with simple projects list\n      return selectedOrg.projects;\n    }\n    if (selectedDept === 'all') {\n      return rawProjects;\n    } else if (selectedDept === 'infra') {\n      return rawProjects.filter(p => (p.departmentName || '').toLowerCase().includes('infras') || (p.departmentName || '').toLowerCase().includes('infra'));\n    } else if (selectedDept === 'designstudioz') {\n      return rawProjects.filter(p => (p.departmentName || '').toLowerCase().includes('design'));\n    }\n    return rawProjects;\n  };\n  const calculateTotals = projects => {\n    return projects.reduce((acc, project) => ({\n      budget: acc.budget + (project.budget || 0),\n      spent: acc.spent + (project.spent || 0),\n      profit: acc.profit + (project.profit || 0),\n      ar: acc.ar + (project.ar || 0),\n      ap: acc.ap + (project.ap || 0),\n      team: acc.team + (project.team || 0)\n    }), {\n      budget: 0,\n      spent: 0,\n      profit: 0,\n      ar: 0,\n      ap: 0,\n      team: 0\n    });\n  };\n\n  // called after a new project is created to refresh\n  const handleProjectCreated = async () => {\n    setShowNewProjectForm(false);\n    if (selectedOrg && selectedOrg.id) {\n      // re-load selected organization data (reuse handleOrgSelect)\n      await handleOrgSelect(selectedOrg.id);\n    }\n  };\n\n  // Inline modal component (no separate NewProjectForm file)\n  const NewProjectModal = ({\n    organizationId,\n    departments = [],\n    onCreated,\n    onCancel\n  }) => {\n    _s();\n    const [form, setForm] = useState({\n      name: '',\n      departmentId: '',\n      startDate: '',\n      endDate: '',\n      budget: '',\n      spending: '',\n      status: 'Not Started',\n      description: ''\n    });\n    const [submitting, setSubmitting] = useState(false);\n    useEffect(() => {\n      const prev = document.body.style.overflow;\n      document.body.style.overflow = 'hidden';\n      const onKey = e => {\n        if (e.key === 'Escape') onCancel && onCancel();\n      };\n      window.addEventListener('keydown', onKey);\n      return () => {\n        document.body.style.overflow = prev;\n        window.removeEventListener('keydown', onKey);\n      };\n    }, [onCancel]);\n    const update = (k, v) => setForm(s => ({\n      ...s,\n      [k]: v\n    }));\n    const handleSubmit = async e => {\n      e.preventDefault();\n      if (submitting) return;\n      setSubmitting(true);\n      const payload = {\n        Name: form.name,\n        DepartmentID: form.departmentId || null,\n        OrganizationID: organizationId || null,\n        StartDate: form.startDate || null,\n        EndDate: form.endDate || null,\n        Budget: form.budget ? parseFloat(form.budget) : 0,\n        Spending: form.spending ? parseFloat(form.spending) : 0,\n        Status: form.status,\n        Description: form.description || null\n      };\n      try {\n        const res = await fetch(`${API_BASE}/projects`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(payload)\n        });\n        if (res.ok) {\n          onCreated && onCreated();\n        } else {\n          const err = await res.json().catch(() => ({}));\n          alert('Failed to create project: ' + (err.error || res.statusText));\n        }\n      } catch (err) {\n        console.error(err);\n        alert('Failed to create project');\n      } finally {\n        setSubmitting(false);\n      }\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      onMouseDown: () => onCancel && onCancel(),\n      style: {\n        position: 'fixed',\n        inset: 0,\n        background: 'rgba(0,0,0,0.45)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 2000\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-panel\",\n        role: \"dialog\",\n        \"aria-modal\": \"true\",\n        onMouseDown: e => e.stopPropagation(),\n        style: {\n          width: 720,\n          maxWidth: '95%',\n          background: '#fff',\n          borderRadius: 8,\n          padding: 20,\n          boxShadow: '0 10px 30px rgba(0,0,0,0.25)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            marginBottom: 12\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            style: {\n              margin: 0\n            },\n            children: \"Create New Project\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => onCancel && onCancel(),\n            \"aria-label\": \"Close\",\n            style: {\n              border: 0,\n              background: 'transparent',\n              fontSize: 20,\n              lineHeight: 1,\n              cursor: 'pointer'\n            },\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'grid',\n              gridTemplateColumns: '1fr 1fr',\n              gap: 12\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Project Name\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 352,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                required: true,\n                value: form.name,\n                onChange: e => update('name', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 353,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Department\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 357,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                value: form.departmentId,\n                onChange: e => update('departmentId', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"-- none -- (organization-level)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 359,\n                  columnNumber: 19\n                }, this), departments.map(d => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: d.id,\n                  children: d.name\n                }, d.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 360,\n                  columnNumber: 41\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 358,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Start Date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                value: form.startDate,\n                onChange: e => update('startDate', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 366,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"End Date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 370,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                value: form.endDate,\n                onChange: e => update('endDate', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 371,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Budget\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 375,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                value: form.budget,\n                onChange: e => update('budget', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 376,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 374,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Spending\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 380,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                value: form.spending,\n                onChange: e => update('spending', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 381,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 379,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                gridColumn: '1 / -1'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Status\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 385,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                value: form.status,\n                onChange: e => update('status', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"Not Started\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 387,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"In Progress\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 388,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"Completed\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 389,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"On Hold\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 390,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 386,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 384,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                gridColumn: '1 / -1'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Description (optional)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 395,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                value: form.description,\n                onChange: e => update('description', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                },\n                rows: 3\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              justifyContent: 'flex-end',\n              gap: 8,\n              marginTop: 16\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => onCancel && onCancel(),\n              style: {\n                padding: '8px 14px'\n              },\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              disabled: submitting,\n              style: {\n                padding: '8px 14px'\n              },\n              children: submitting ? 'Creating…' : 'Create Project'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 402,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 7\n    }, this);\n  };\n  _s(NewProjectModal, \"u1sl/gAALcDAQSDJuWXmQoPxWtI=\");\n  const handleFileUpload = e => {\n    setUploadError('');\n    const file = e.target.files[0];\n    if (!file) return;\n    setUploadFileName(file.name);\n    const reader = new FileReader();\n    reader.onload = evt => {\n      try {\n        const data = evt.target.result;\n        const workbook = XLSX.read(data, {\n          type: 'binary'\n        });\n        const sheetName = workbook.SheetNames[0];\n        const sheet = workbook.Sheets[sheetName];\n        const json = XLSX.utils.sheet_to_json(sheet, {\n          defval: ''\n        });\n        setUploadedData(json);\n      } catch (err) {\n        setUploadError('Failed to parse file. Please upload a valid Excel or CSV.');\n      }\n    };\n    reader.readAsBinaryString(file);\n  };\n\n  // Helper function to calculate metrics from Excel data\n  const getExcelMetrics = data => {\n    let totalAmount = 0;\n    const byCategory = {};\n    const byExpenseType = {};\n    data.forEach(row => {\n      const amount = Number(row.Amount || 0);\n      totalAmount += amount;\n      const category = row.Category || 'Uncategorized';\n      byCategory[category] = (byCategory[category] || 0) + amount;\n      const expenseType = row.ExpenseType || 'Expense';\n      byExpenseType[expenseType] = (byExpenseType[expenseType] || 0) + amount;\n    });\n    return {\n      totalAmount,\n      byCategory,\n      byExpenseType\n    };\n  };\n  const handleSaveToDB = async () => {\n    if (!uploadedData.length) return;\n    const res = await fetch(`${API_BASE}/import-transactions`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        rows: uploadedData,\n        uploaderEmail: userEmail,\n        fileName: uploadFileName,\n        organizationId: (selectedOrg === null || selectedOrg === void 0 ? void 0 : selectedOrg.id) || null\n      })\n    });\n    const result = await res.json();\n    alert(result.message || 'Import complete');\n    setShowUploadedPreview(true); // Show preview after saving\n  };\n\n  // Move this helper function up, before you use it!\n  const getFilteredUploadedData = () => {\n    if (!uploadedData.length) return [];\n    if (!dateFilter.from && !dateFilter.to) return uploadedData;\n    return uploadedData.filter(row => {\n      const rowDate = row.Date || row.TxnDate;\n      if (!rowDate) return false;\n      const d = new Date(rowDate);\n      const from = dateFilter.from ? new Date(dateFilter.from) : null;\n      const to = dateFilter.to ? new Date(dateFilter.to) : null;\n      if (from && d < from) return false;\n      if (to && d > to) return false;\n      return true;\n    });\n  };\n  const filteredExcelData = getFilteredUploadedData();\n  const metrics = getExcelMetrics(filteredExcelData);\n  const renderExcelCards = metrics => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      gap: 24,\n      marginBottom: 24\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        flex: 1,\n        background: '#e0f2fe',\n        padding: 18,\n        borderRadius: 8,\n        cursor: 'pointer'\n      },\n      onClick: () => setShowAmountPopup(true),\n      title: \"Click to view breakdown\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Total Amount\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: 28,\n          fontWeight: 700\n        },\n        children: metrics.totalAmount.toLocaleString()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 500,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 493,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        flex: 1,\n        background: '#fef9c3',\n        padding: 18,\n        borderRadius: 8\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Categories\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 503,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        style: {\n          margin: 0,\n          padding: 0,\n          listStyle: 'none'\n        },\n        children: Object.entries(metrics.byCategory).map(([cat, amt]) => /*#__PURE__*/_jsxDEV(\"li\", {\n          style: {\n            fontSize: 16\n          },\n          children: [cat, \": \", /*#__PURE__*/_jsxDEV(\"b\", {\n            children: amt.toLocaleString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 506,\n            columnNumber: 59\n          }, this)]\n        }, cat, true, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 504,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 502,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        flex: 1,\n        background: '#dcfce7',\n        padding: 18,\n        borderRadius: 8\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Expense Types\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 511,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        style: {\n          margin: 0,\n          padding: 0,\n          listStyle: 'none'\n        },\n        children: Object.entries(metrics.byExpenseType).map(([type, amt]) => /*#__PURE__*/_jsxDEV(\"li\", {\n          style: {\n            fontSize: 16\n          },\n          children: [type, \": \", /*#__PURE__*/_jsxDEV(\"b\", {\n            children: amt.toLocaleString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 514,\n            columnNumber: 61\n          }, this)]\n        }, type, true, {\n          fileName: _jsxFileName,\n          lineNumber: 514,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 512,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 510,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 492,\n    columnNumber: 5\n  }, this);\n  const renderExcelCharts = metrics => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      gap: 32,\n      marginBottom: 24\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Amount by Category\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 524,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Pie, {\n        data: {\n          labels: Object.keys(metrics.byCategory),\n          datasets: [{\n            data: Object.values(metrics.byCategory),\n            backgroundColor: ['#3b82f6', '#10b981', '#f59e42', '#f43f5e', '#6366f1', '#fef9c3']\n          }]\n        },\n        options: {\n          plugins: {\n            legend: {\n              position: 'bottom'\n            }\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 525,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 523,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Amount by Expense Type\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 537,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Bar, {\n        data: {\n          labels: Object.keys(metrics.byExpenseType),\n          datasets: [{\n            label: 'Amount',\n            data: Object.values(metrics.byExpenseType),\n            backgroundColor: '#3b82f6'\n          }]\n        },\n        options: {\n          plugins: {\n            legend: {\n              display: false\n            }\n          },\n          scales: {\n            y: {\n              beginAtZero: true\n            }\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 538,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 536,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 522,\n    columnNumber: 5\n  }, this);\n  const renderRecentTransactions = data => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginBottom: 24\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n      children: \"Recent Transactions\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 558,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: 16,\n        flexWrap: 'wrap'\n      },\n      children: data.slice(0, 5).map((row, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          background: '#fff',\n          border: '1px solid #eee',\n          borderRadius: 8,\n          padding: 14,\n          minWidth: 180,\n          boxShadow: '0 2px 8px #f3f4f6'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: 600\n          },\n          children: row.Category || 'Uncategorized'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 564,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: '#3b82f6',\n            fontSize: 18\n          },\n          children: Number(row.Amount || 0).toLocaleString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 565,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: 12,\n            color: '#666'\n          },\n          children: [row.ExpenseType || 'Expense', \" | \", row.Date || row.TxnDate]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 566,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: 12,\n            color: '#888'\n          },\n          children: row.Note || row.Description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 567,\n          columnNumber: 13\n        }, this)]\n      }, idx, true, {\n        fileName: _jsxFileName,\n        lineNumber: 561,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 559,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 557,\n    columnNumber: 5\n  }, this);\n\n  // Helper to extract initial amount from uploaded Excel data\n  const getInitialAmountFromExcel = data => {\n    if (!data || !data.length) return 0;\n    // Look for a row with Category: \"Initial\" or ExpenseType: \"Initial\"\n    const initialRow = data.find(row => row.Category && row.Category.toLowerCase() === 'initial' || row.ExpenseType && row.ExpenseType.toLowerCase() === 'initial');\n    if (initialRow) {\n      return Number(initialRow.Amount || 0);\n    }\n    // Optionally, fallback to first row if you want\n    // return Number(data[0].Amount || 0);\n    return 0;\n  };\n  const getAmountBreakdown = data => {\n    // Dynamically get initial amount from Excel\n    const initialAmount = getInitialAmountFromExcel(data);\n    let totalExpenses = 0;\n    let totalIncome = 0;\n    const expenseDetails = {};\n    const incomeDetails = {};\n    data.forEach(row => {\n      // Skip initial amount row from expense/income calculation\n      const isInitial = row.Category && row.Category.toLowerCase() === 'initial' || row.ExpenseType && row.ExpenseType.toLowerCase() === 'initial';\n      if (isInitial) return;\n      const amt = Number(row.Amount || 0);\n      const type = (row.Category || '').toLowerCase();\n      const expType = row.ExpenseType || 'Expense';\n      if (type === 'expense' || expType.toLowerCase() === 'expense') {\n        totalExpenses += amt;\n        expenseDetails[expType] = (expenseDetails[expType] || 0) + amt;\n      } else if (type === 'receipt' || expType.toLowerCase() === 'receipt' || expType.toLowerCase() === 'income') {\n        totalIncome += amt;\n        incomeDetails[expType] = (incomeDetails[expType] || 0) + amt;\n      }\n    });\n    const remaining = initialAmount + totalIncome - totalExpenses;\n    return {\n      initialAmount,\n      totalExpenses,\n      totalIncome,\n      remaining,\n      expenseDetails,\n      incomeDetails\n    };\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      isLoggedIn: isLoggedIn,\n      onLogout: onLogout\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 626,\n      columnNumber: 7\n    }, this), view === 'organizations' && /*#__PURE__*/_jsxDEV(OrganizationSelector, {\n      organizations: organizations,\n      onSelect: handleOrgSelect\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 628,\n      columnNumber: 9\n    }, this), view === 'project' && selectedProject && /*#__PURE__*/_jsxDEV(ProjectDashboard, {\n      project: selectedProject,\n      organization: selectedOrg,\n      onBack: handleBack\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 635,\n      columnNumber: 9\n    }, this), view === 'dashboard' && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(CompanyDashboard, {\n        organization: selectedOrg,\n        selectedDept: selectedDept,\n        onDeptChange: setSelectedDept,\n        onProjectSelect: handleProjectSelect,\n        onBack: handleBack,\n        projects: getFilteredProjects(),\n        totals: Object.keys(totals).length ? totals : totals,\n        onAddProject: setShowNewProjectForm,\n        onFileUpload: handleFileUpload\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 644,\n        columnNumber: 11\n      }, this), showNewProjectForm && selectedOrg && /*#__PURE__*/_jsxDEV(NewProjectModal, {\n        organizationId: selectedOrg.id,\n        departments: departments,\n        onCreated: handleProjectCreated,\n        onCancel: () => setShowNewProjectForm(false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 656,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true), showAmountPopup && uploadedData.length > 0 && /*#__PURE__*/_jsxDEV(AmountBreakdownPopup, {\n      breakdown: getAmountBreakdown(uploadedData),\n      onClose: () => setShowAmountPopup(false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 668,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n_s2(OrganizationDashboard, \"UeX2r1EE3SLXoI53bPwOXJhwWbM=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = OrganizationDashboard;\nconst AmountBreakdownPopup = ({\n  breakdown,\n  onClose\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  style: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: '100vw',\n    height: '100vh',\n    background: 'rgba(0,0,0,0.35)',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    zIndex: 9999\n  },\n  children: /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      background: '#fff',\n      borderRadius: 10,\n      padding: 32,\n      minWidth: 340,\n      boxShadow: '0 4px 24px #0002',\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: onClose,\n      style: {\n        position: 'absolute',\n        top: 12,\n        right: 16,\n        background: 'none',\n        border: 'none',\n        fontSize: 22,\n        cursor: 'pointer'\n      },\n      \"aria-label\": \"Close\",\n      children: \"\\xD7\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 685,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        marginTop: 0\n      },\n      children: \"Total Amount Breakdown\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 692,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"Initial Amount:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 694,\n        columnNumber: 9\n      }, this), \" \\u20B9\", breakdown.initialAmount.toLocaleString()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 693,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"Total Expenses:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 697,\n        columnNumber: 9\n      }, this), \" \\u20B9\", breakdown.totalExpenses.toLocaleString(), /*#__PURE__*/_jsxDEV(\"ul\", {\n        style: {\n          margin: '8px 0 0 16px',\n          padding: 0\n        },\n        children: Object.entries(breakdown.expenseDetails).map(([cat, amt]) => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [cat, \": \\u20B9\", amt.toLocaleString()]\n        }, cat, true, {\n          fileName: _jsxFileName,\n          lineNumber: 700,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 698,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 696,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"Total Income:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 705,\n        columnNumber: 9\n      }, this), \" \\u20B9\", breakdown.totalIncome.toLocaleString(), /*#__PURE__*/_jsxDEV(\"ul\", {\n        style: {\n          margin: '8px 0 0 16px',\n          padding: 0\n        },\n        children: Object.entries(breakdown.incomeDetails).map(([cat, amt]) => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [cat, \": \\u20B9\", amt.toLocaleString()]\n        }, cat, true, {\n          fileName: _jsxFileName,\n          lineNumber: 708,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 706,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 704,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        fontSize: 18,\n        fontWeight: 600,\n        color: '#10b981'\n      },\n      children: [\"Remaining Balance: \\u20B9\", breakdown.remaining.toLocaleString()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 712,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 682,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 678,\n  columnNumber: 3\n}, this);\n_c2 = AmountBreakdownPopup;\nexport default OrganizationDashboard;\nvar _c, _c2;\n$RefreshReg$(_c, \"OrganizationDashboard\");\n$RefreshReg$(_c2, \"AmountBreakdownPopup\");","map":{"version":3,"names":["React","useState","useEffect","Building2","Code","useNavigate","useLocation","OrganizationSelector","CompanyDashboard","ProjectDashboard","Header","XLSX","Bar","Pie","Chart","ArcElement","BarElement","CategoryScale","LinearScale","Tooltip","Legend","jsxDEV","_jsxDEV","Fragment","_Fragment","register","API_BASE","OrganizationDashboard","isLoggedIn","onLogout","_s2","_location$state","_location$state2","_s","$RefreshSig$","location","userEmail","state","organizationId","view","setView","localStorage","getItem","selectedOrg","setSelectedOrg","org","JSON","parse","selectedDept","setSelectedDept","selectedProject","setSelectedProject","proj","organizations","setOrganizations","rawProjects","setRawProjects","departments","setDepartments","totals","setTotals","budget","spent","profit","ar","ap","team","showNewProjectForm","setShowNewProjectForm","uploadedData","setUploadedData","uploadError","setUploadError","uploadFileName","setUploadFileName","showAmountPopup","setShowAmountPopup","dateFilter","setDateFilter","from","to","showUploadedPreview","setShowUploadedPreview","navigate","setItem","stringify","loadOrgs","res","fetch","data","json","mapped","map","o","id","OrganizationID","name","Name","type","Type","description","Description","icon","toLowerCase","includes","color","err","console","error","length","orgToSelect","find","Number","handleOrgSelect","orgId","_organizations$find","_organizations$find2","orgRes","orgData","projRes","projRows","deptRes","deptRows","mappedProjects","p","Budget","Spending","Profit","undefined","ProjectID","ProjectId","ProjectName","status","Status","toString","AR","AP","Team","deadline","EndDate","departmentName","DepartmentName","projects","d","DepartmentID","dashRes","ok","dash","totalBudget","totalSpending","totalAR","totalAP","reduce","s","computeTotalsFromProjects","t","acc","project","handleProjectSelect","handleBack","getFilteredProjects","filter","calculateTotals","handleProjectCreated","NewProjectModal","onCreated","onCancel","form","setForm","departmentId","startDate","endDate","spending","submitting","setSubmitting","prev","document","body","style","overflow","onKey","e","key","window","addEventListener","removeEventListener","update","k","v","handleSubmit","preventDefault","payload","StartDate","parseFloat","method","headers","catch","alert","statusText","className","onMouseDown","position","inset","background","display","alignItems","justifyContent","zIndex","children","role","stopPropagation","width","maxWidth","borderRadius","padding","boxShadow","marginBottom","margin","fileName","_jsxFileName","lineNumber","columnNumber","onClick","border","fontSize","lineHeight","cursor","onSubmit","gridTemplateColumns","gap","required","value","onChange","target","gridColumn","rows","marginTop","disabled","handleFileUpload","file","files","reader","FileReader","onload","evt","result","workbook","read","sheetName","SheetNames","sheet","Sheets","utils","sheet_to_json","defval","readAsBinaryString","getExcelMetrics","totalAmount","byCategory","byExpenseType","forEach","row","amount","Amount","category","Category","expenseType","ExpenseType","handleSaveToDB","uploaderEmail","message","getFilteredUploadedData","rowDate","Date","TxnDate","filteredExcelData","metrics","renderExcelCards","flex","title","fontWeight","toLocaleString","listStyle","Object","entries","cat","amt","renderExcelCharts","labels","keys","datasets","values","backgroundColor","options","plugins","legend","label","scales","y","beginAtZero","renderRecentTransactions","flexWrap","slice","idx","minWidth","Note","getInitialAmountFromExcel","initialRow","getAmountBreakdown","initialAmount","totalExpenses","totalIncome","expenseDetails","incomeDetails","isInitial","expType","remaining","onSelect","organization","onBack","onDeptChange","onProjectSelect","onAddProject","onFileUpload","AmountBreakdownPopup","breakdown","onClose","_c","top","left","height","right","_c2","$RefreshReg$"],"sources":["C:/Users/VivekReddyMeka/Desktop/Accounts_Management/src/Components/Dashboard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Building2, Code } from 'lucide-react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport OrganizationSelector from './OrganizationSelector';\r\nimport CompanyDashboard from './CompanyDashboard';\r\nimport ProjectDashboard from './ProjectDashboard';\r\nimport Header from './Header';\r\nimport '../Styles/Dashboard.css'; // Import the CSS file\r\nimport * as XLSX from 'xlsx'; // Add at top\r\nimport { Bar, Pie } from 'react-chartjs-2';\r\nimport { Chart, ArcElement, BarElement, CategoryScale, LinearScale, Tooltip, Legend } from 'chart.js';\r\nChart.register(ArcElement, BarElement, CategoryScale, LinearScale, Tooltip, Legend);\r\n \r\nconst API_BASE = 'http://localhost:3001'; // adjust if your server runs elsewhere\r\n \r\n// Main Dashboard Component (now loads data from DB via API)\r\nconst OrganizationDashboard = ({ isLoggedIn, onLogout }) => {\r\n  const location = useLocation();\r\n  const userEmail = location.state?.userEmail || '';\r\n  const organizationId = location.state?.organizationId || null;\r\n \r\n  // Load initial view from localStorage, fallback to 'organizations'\r\n  const [view, setView] = useState(() => localStorage.getItem('dashboardView') || 'organizations');\r\n  const [selectedOrg, setSelectedOrg] = useState(() => {\r\n    const org = localStorage.getItem('selectedOrg');\r\n    return org ? JSON.parse(org) : null;\r\n  });\r\n  const [selectedDept, setSelectedDept] = useState(() => localStorage.getItem('selectedDept') || 'all');\r\n  const [selectedProject, setSelectedProject] = useState(() => {\r\n    const proj = localStorage.getItem('selectedProject');\r\n    return proj ? JSON.parse(proj) : null;\r\n  });\r\n  const [organizations, setOrganizations] = useState([]);\r\n  const [rawProjects, setRawProjects] = useState([]); // raw rows from API (contain DepartmentName etc.)\r\n  const [departments, setDepartments] = useState([]);\r\n  const [totals, setTotals] = useState({ budget:0, spent:0, profit:0, ar:0, ap:0, team:0 });\r\n  const [showNewProjectForm, setShowNewProjectForm] = useState(false);\r\n  const [uploadedData, setUploadedData] = useState([]);\r\n  const [uploadError, setUploadError] = useState('');\r\n  const [uploadFileName, setUploadFileName] = useState('');\r\n  const [showAmountPopup, setShowAmountPopup] = useState(false);\r\n  const [dateFilter, setDateFilter] = useState({ from: '', to: '' });\r\n  const [showUploadedPreview, setShowUploadedPreview] = useState(false);\r\n  const navigate = useNavigate(); // Add this line\r\n \r\n  // Save view/page state to localStorage whenever it changes\r\n  useEffect(() => {\r\n    localStorage.setItem('dashboardView', view);\r\n  }, [view]);\r\n  useEffect(() => {\r\n    localStorage.setItem('selectedOrg', JSON.stringify(selectedOrg));\r\n  }, [selectedOrg]);\r\n  useEffect(() => {\r\n    localStorage.setItem('selectedDept', selectedDept);\r\n  }, [selectedDept]);\r\n  useEffect(() => {\r\n    localStorage.setItem('selectedProject', JSON.stringify(selectedProject));\r\n  }, [selectedProject]);\r\n \r\n  useEffect(() => {\r\n    // load organizations list\r\n    const loadOrgs = async () => {\r\n      try {\r\n        const res = await fetch(`${API_BASE}/organizations`);\r\n        const data = await res.json();\r\n        const mapped = data.map(o => ({\r\n          id: o.OrganizationID,\r\n          name: o.Name,\r\n          type: o.Type || '',\r\n          description: o.Description || '',\r\n          // choose icons/colors by name/type to keep existing UI consistent\r\n          icon: o.Name && o.Name.toLowerCase().includes('collabridge') ? Code : Building2,\r\n          color: o.Name && o.Name.toLowerCase().includes('la tierra') ? '#10b981' : '#3b82f6'\r\n        }));\r\n        setOrganizations(mapped);\r\n      } catch (err) {\r\n        console.error('Error loading organizations:', err);\r\n      }\r\n    };\r\n    loadOrgs();\r\n  }, []);\r\n \r\n  // Auto-select organization based on email domain\r\n  // useEffect(() => {\r\n  //   if (!userEmail || !organizations.length) return;\r\n \r\n  //   let orgToSelect = null;\r\n  //   if (userEmail.toLowerCase().endsWith('@collabridge.com')) {\r\n  //     orgToSelect = organizations.find(o => o.name.toLowerCase().includes('collabridge'));\r\n  //   } else if (userEmail.toLowerCase().endsWith('@latierra.com')) {\r\n  //     orgToSelect = organizations.find(o => o.name.toLowerCase().includes('la tierra') || o.name.toLowerCase().includes('buildcraft'));\r\n  //   }\r\n \r\n  //   if (orgToSelect && (!selectedOrg || selectedOrg.id !== orgToSelect.id)) {\r\n  //     handleOrgSelect(orgToSelect.id);\r\n  //   }\r\n  // }, [userEmail, organizations]);\r\n \r\n  // Auto-select organization if organizationId is present\r\n  useEffect(() => {\r\n  if (!organizationId || !organizations.length) return;\r\n  const orgToSelect = organizations.find(o => o.id === Number(organizationId));\r\n  if (orgToSelect && (!selectedOrg || selectedOrg.id !== orgToSelect.id)) {\r\n    handleOrgSelect(orgToSelect.id);\r\n  }\r\n}, [organizationId, organizations]);\r\n \r\n  const handleOrgSelect = async (orgId) => {\r\n    setSelectedDept('all');\r\n    setSelectedProject(null);\r\n    setView('dashboard');\r\n \r\n    try {\r\n      // get organization details\r\n      const orgRes = await fetch(`${API_BASE}/organizations/${orgId}`);\r\n      const orgData = await orgRes.json();\r\n \r\n      // projects for organization\r\n      const projRes = await fetch(`${API_BASE}/projects?organizationId=${orgId}`);\r\n      const projRows = await projRes.json();\r\n \r\n      // departments list for filters\r\n      const deptRes = await fetch(`${API_BASE}/departments?organizationId=${orgId}`);\r\n      const deptRows = await deptRes.json();\r\n \r\n      // map project rows to the shape used by UI (keep DepartmentName for filtering)\r\n      const mappedProjects = (projRows || []).map(p => {\r\n        const budget = Number(p.Budget || 0);\r\n        const spent = Number(p.Spending || 0);\r\n        const profit = Number(p.Profit !== undefined ? p.Profit : (budget - spent));\r\n        return {\r\n          id: p.ProjectID || p.ProjectId || p.id,\r\n          name: p.ProjectName || p.Name || '',\r\n          status: (p.Status || '').toString(),\r\n          budget,\r\n          spent,\r\n          profit,\r\n          ar: Number(p.AR || 0),            // fallback 0, server may not supply project-level AR\r\n          ap: Number(p.AP !== undefined ? p.AP : spent), // fallback to spent as payable approximation\r\n          team: Number(p.Team || 0),        // not present in DB seed -> 0 unless backend supplies it\r\n          deadline: p.EndDate || p.deadline || '',\r\n          departmentName: p.DepartmentName || ''\r\n        };\r\n      });\r\n \r\n      setRawProjects(mappedProjects);\r\n      // set selectedOrg with API info + mapped projects\r\n      setSelectedOrg({\r\n        id: orgData.OrganizationID || orgId,\r\n        name: orgData.Name || '',\r\n        type: orgData.Type || '',\r\n        description: orgData.Description || '',\r\n        projects: mappedProjects,\r\n        color: organizations.find(o => o.id === orgId)?.color || '#3b82f6',\r\n        icon: organizations.find(o => o.id === orgId)?.icon || Building2\r\n      });\r\n \r\n      // normalize departments\r\n      setDepartments((deptRows || []).map(d => ({ id: d.DepartmentID, name: d.Name })));\r\n \r\n      // totals: try to use organization dashboard endpoint\r\n      try {\r\n        const dashRes = await fetch(`${API_BASE}/organizations/${orgId}/dashboard`);\r\n        if (dashRes.ok) {\r\n          const dash = await dashRes.json();\r\n          setTotals({\r\n            budget: Number(dash.totalBudget || 0),\r\n            spent: Number(dash.totalSpending || 0),\r\n            profit: Number(dash.totalBudget || 0) - Number(dash.totalSpending || 0),\r\n            ar: Number(dash.totalAR || 0),\r\n            ap: Number(dash.totalAP || 0),\r\n            team: mappedProjects.reduce((s,p) => s + (p.team||0), 0)\r\n          });\r\n        } else {\r\n          // fallback compute from projects\r\n          computeTotalsFromProjects(mappedProjects);\r\n        }\r\n      } catch (err) {\r\n        computeTotalsFromProjects(mappedProjects);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error selecting organization:', err);\r\n    }\r\n  };\r\n \r\n  const computeTotalsFromProjects = (projects) => {\r\n    const t = projects.reduce((acc, project) => ({\r\n      budget: acc.budget + (project.budget || 0),\r\n      spent: acc.spent + (project.spent || 0),\r\n      profit: acc.profit + (project.profit || 0),\r\n      ar: acc.ar + (project.ar || 0),\r\n      ap: acc.ap + (project.ap || 0),\r\n      team: acc.team + (project.team || 0)\r\n    }), { budget:0, spent:0, profit:0, ar:0, ap:0, team:0 });\r\n    setTotals(t);\r\n  };\r\n \r\n  const handleProjectSelect = (project) => {\r\n    // project could be raw project object from projects list\r\n    setSelectedProject(project);\r\n    setView('project');\r\n  };\r\n \r\n  const handleBack = () => {\r\n    if (view === 'project') {\r\n      setView('dashboard');\r\n      setSelectedProject(null);\r\n    } else {\r\n      setView('organizations');\r\n      setSelectedOrg(null);\r\n      setSelectedDept('all');\r\n      setRawProjects([]);\r\n      setDepartments([]);\r\n      setTotals({ budget:0, spent:0, profit:0, ar:0, ap:0, team:0 });\r\n    }\r\n  };\r\n \r\n  const getFilteredProjects = () => {\r\n    if (!selectedOrg) return [];\r\n \r\n    if (selectedOrg.id === 1 && selectedOrg.projects) {\r\n      // legacy behavior: org 1 is \"software\" with simple projects list\r\n      return selectedOrg.projects;\r\n    }\r\n \r\n    if (selectedDept === 'all') {\r\n      return rawProjects;\r\n    } else if (selectedDept === 'infra') {\r\n      return rawProjects.filter(p => (p.departmentName || '').toLowerCase().includes('infras') || (p.departmentName || '').toLowerCase().includes('infra'));\r\n    } else if (selectedDept === 'designstudioz') {\r\n      return rawProjects.filter(p => (p.departmentName || '').toLowerCase().includes('design'));\r\n    }\r\n    return rawProjects;\r\n  };\r\n \r\n  const calculateTotals = (projects) => {\r\n    return projects.reduce((acc, project) => ({\r\n      budget: acc.budget + (project.budget || 0),\r\n      spent: acc.spent + (project.spent || 0),\r\n      profit: acc.profit + (project.profit || 0),\r\n      ar: acc.ar + (project.ar || 0),\r\n      ap: acc.ap + (project.ap || 0),\r\n      team: acc.team + (project.team || 0)\r\n    }), { budget: 0, spent: 0, profit: 0, ar: 0, ap: 0, team: 0 });\r\n  };\r\n \r\n  // called after a new project is created to refresh\r\n  const handleProjectCreated = async () => {\r\n    setShowNewProjectForm(false);\r\n    if (selectedOrg && selectedOrg.id) {\r\n      // re-load selected organization data (reuse handleOrgSelect)\r\n      await handleOrgSelect(selectedOrg.id);\r\n    }\r\n  };\r\n \r\n  // Inline modal component (no separate NewProjectForm file)\r\n  const NewProjectModal = ({ organizationId, departments = [], onCreated, onCancel }) => {\r\n    const [form, setForm] = useState({\r\n      name: '',\r\n      departmentId: '',\r\n      startDate: '',\r\n      endDate: '',\r\n      budget: '',\r\n      spending: '',\r\n      status: 'Not Started',\r\n      description: ''\r\n    });\r\n    const [submitting, setSubmitting] = useState(false);\r\n \r\n    useEffect(() => {\r\n      const prev = document.body.style.overflow;\r\n      document.body.style.overflow = 'hidden';\r\n      const onKey = (e) => { if (e.key === 'Escape') onCancel && onCancel(); };\r\n      window.addEventListener('keydown', onKey);\r\n      return () => {\r\n        document.body.style.overflow = prev;\r\n        window.removeEventListener('keydown', onKey);\r\n      };\r\n    }, [onCancel]);\r\n \r\n    const update = (k, v) => setForm(s => ({ ...s, [k]: v }));\r\n \r\n    const handleSubmit = async (e) => {\r\n      e.preventDefault();\r\n      if (submitting) return;\r\n      setSubmitting(true);\r\n      const payload = {\r\n        Name: form.name,\r\n        DepartmentID: form.departmentId || null,\r\n        OrganizationID: organizationId || null,\r\n        StartDate: form.startDate || null,\r\n        EndDate: form.endDate || null,\r\n        Budget: form.budget ? parseFloat(form.budget) : 0,\r\n        Spending: form.spending ? parseFloat(form.spending) : 0,\r\n        Status: form.status,\r\n        Description: form.description || null\r\n      };\r\n      try {\r\n        const res = await fetch(`${API_BASE}/projects`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(payload)\r\n        });\r\n        if (res.ok) {\r\n          onCreated && onCreated();\r\n        } else {\r\n          const err = await res.json().catch(()=>({}));\r\n          alert('Failed to create project: ' + (err.error || res.statusText));\r\n        }\r\n      } catch (err) {\r\n        console.error(err);\r\n        alert('Failed to create project');\r\n      } finally {\r\n        setSubmitting(false);\r\n      }\r\n    };\r\n \r\n    return (\r\n      <div\r\n        className=\"modal-overlay\"\r\n        onMouseDown={() => onCancel && onCancel()}\r\n        style={{\r\n          position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.45)', display: 'flex',\r\n          alignItems: 'center', justifyContent: 'center', zIndex: 2000\r\n        }}\r\n      >\r\n        <div\r\n          className=\"modal-panel\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => e.stopPropagation()}\r\n          style={{\r\n            width: 720, maxWidth: '95%', background: '#fff', borderRadius: 8, padding: 20,\r\n            boxShadow: '0 10px 30px rgba(0,0,0,0.25)'\r\n          }}\r\n        >\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 12 }}>\r\n            <h2 style={{ margin: 0 }}>Create New Project</h2>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => onCancel && onCancel()}\r\n              aria-label=\"Close\"\r\n              style={{ border: 0, background: 'transparent', fontSize: 20, lineHeight: 1, cursor: 'pointer' }}\r\n            >\r\n              ×\r\n            </button>\r\n          </div>\r\n \r\n          <form onSubmit={handleSubmit}>\r\n            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 12 }}>\r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Project Name</label>\r\n                <input required value={form.name} onChange={e => update('name', e.target.value)} style={{ width: '100%', padding: 8 }} />\r\n              </div>\r\n \r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Department</label>\r\n                <select value={form.departmentId} onChange={e => update('departmentId', e.target.value)} style={{ width: '100%', padding: 8 }}>\r\n                  <option value=\"\">-- none -- (organization-level)</option>\r\n                  {departments.map(d => <option key={d.id} value={d.id}>{d.name}</option>)}\r\n                </select>\r\n              </div>\r\n \r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Start Date</label>\r\n                <input type=\"date\" value={form.startDate} onChange={e => update('startDate', e.target.value)} style={{ width: '100%', padding: 8 }} />\r\n              </div>\r\n \r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>End Date</label>\r\n                <input type=\"date\" value={form.endDate} onChange={e => update('endDate', e.target.value)} style={{ width: '100%', padding: 8 }} />\r\n              </div>\r\n \r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Budget</label>\r\n                <input type=\"number\" value={form.budget} onChange={e => update('budget', e.target.value)} style={{ width: '100%', padding: 8 }} />\r\n              </div>\r\n \r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Spending</label>\r\n                <input type=\"number\" value={form.spending} onChange={e => update('spending', e.target.value)} style={{ width: '100%', padding: 8 }} />\r\n              </div>\r\n \r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Status</label>\r\n                <select value={form.status} onChange={e => update('status', e.target.value)} style={{ width: '100%', padding: 8 }}>\r\n                  <option>Not Started</option>\r\n                  <option>In Progress</option>\r\n                  <option>Completed</option>\r\n                  <option>On Hold</option>\r\n                </select>\r\n              </div>\r\n \r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Description (optional)</label>\r\n                <textarea value={form.description} onChange={e => update('description', e.target.value)} style={{ width: '100%', padding: 8 }} rows={3} />\r\n              </div>\r\n            </div>\r\n \r\n            <div style={{ display: 'flex', justifyContent: 'flex-end', gap: 8, marginTop: 16 }}>\r\n              <button type=\"button\" onClick={() => onCancel && onCancel()} style={{ padding: '8px 14px' }}>Cancel</button>\r\n              <button type=\"submit\" disabled={submitting} style={{ padding: '8px 14px' }}>\r\n                {submitting ? 'Creating…' : 'Create Project'}\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n \r\n  const handleFileUpload = (e) => {\r\n    setUploadError('');\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n \r\n    setUploadFileName(file.name);\r\n \r\n    const reader = new FileReader();\r\n    reader.onload = (evt) => {\r\n      try {\r\n        const data = evt.target.result;\r\n        const workbook = XLSX.read(data, { type: 'binary' });\r\n        const sheetName = workbook.SheetNames[0];\r\n        const sheet = workbook.Sheets[sheetName];\r\n        const json = XLSX.utils.sheet_to_json(sheet, { defval: '' });\r\n        setUploadedData(json);\r\n      } catch (err) {\r\n        setUploadError('Failed to parse file. Please upload a valid Excel or CSV.');\r\n      }\r\n    };\r\n    reader.readAsBinaryString(file);\r\n  };\r\n \r\n    // Helper function to calculate metrics from Excel data\r\n  const getExcelMetrics = (data) => {\r\n    let totalAmount = 0;\r\n    const byCategory = {};\r\n    const byExpenseType = {};\r\n \r\n    data.forEach(row => {\r\n      const amount = Number(row.Amount || 0);\r\n      totalAmount += amount;\r\n \r\n      const category = row.Category || 'Uncategorized';\r\n      byCategory[category] = (byCategory[category] || 0) + amount;\r\n \r\n      const expenseType = row.ExpenseType || 'Expense';\r\n      byExpenseType[expenseType] = (byExpenseType[expenseType] || 0) + amount;\r\n    });\r\n \r\n    return { totalAmount, byCategory, byExpenseType };\r\n  };\r\n \r\n    const handleSaveToDB = async () => {\r\n      if (!uploadedData.length) return;\r\n      const res = await fetch(`${API_BASE}/import-transactions`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({\r\n        rows: uploadedData,\r\n        uploaderEmail: userEmail,\r\n        fileName: uploadFileName,\r\n        organizationId: selectedOrg?.id || null\r\n      })\r\n    });\r\n    const result = await res.json();\r\n    alert(result.message || 'Import complete');\r\n    setShowUploadedPreview(true); // Show preview after saving\r\n  };\r\n \r\n  // Move this helper function up, before you use it!\r\n  const getFilteredUploadedData = () => {\r\n    if (!uploadedData.length) return [];\r\n    if (!dateFilter.from && !dateFilter.to) return uploadedData;\r\n    return uploadedData.filter(row => {\r\n      const rowDate = row.Date || row.TxnDate;\r\n      if (!rowDate) return false;\r\n      const d = new Date(rowDate);\r\n      const from = dateFilter.from ? new Date(dateFilter.from) : null;\r\n      const to = dateFilter.to ? new Date(dateFilter.to) : null;\r\n      if (from && d < from) return false;\r\n      if (to && d > to) return false;\r\n      return true;\r\n    });\r\n  };\r\n \r\n  const filteredExcelData = getFilteredUploadedData();\r\n  const metrics = getExcelMetrics(filteredExcelData);\r\n \r\n  const renderExcelCards = (metrics) => (\r\n    <div style={{ display: 'flex', gap: 24, marginBottom: 24 }}>\r\n      <div\r\n        className=\"card\"\r\n        style={{ flex: 1, background: '#e0f2fe', padding: 18, borderRadius: 8, cursor: 'pointer' }}\r\n        onClick={() => setShowAmountPopup(true)}\r\n        title=\"Click to view breakdown\"\r\n      >\r\n        <h4>Total Amount</h4>\r\n        <div style={{ fontSize: 28, fontWeight: 700 }}>{metrics.totalAmount.toLocaleString()}</div>\r\n      </div>\r\n      <div className=\"card\" style={{ flex: 1, background: '#fef9c3', padding: 18, borderRadius: 8 }}>\r\n        <h4>Categories</h4>\r\n        <ul style={{ margin: 0, padding: 0, listStyle: 'none' }}>\r\n          {Object.entries(metrics.byCategory).map(([cat, amt]) => (\r\n            <li key={cat} style={{ fontSize: 16 }}>{cat}: <b>{amt.toLocaleString()}</b></li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n      <div className=\"card\" style={{ flex: 1, background: '#dcfce7', padding: 18, borderRadius: 8 }}>\r\n        <h4>Expense Types</h4>\r\n        <ul style={{ margin: 0, padding: 0, listStyle: 'none' }}>\r\n          {Object.entries(metrics.byExpenseType).map(([type, amt]) => (\r\n            <li key={type} style={{ fontSize: 16 }}>{type}: <b>{amt.toLocaleString()}</b></li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n \r\n  const renderExcelCharts = (metrics) => (\r\n    <div style={{ display: 'flex', gap: 32, marginBottom: 24 }}>\r\n      <div style={{ flex: 1 }}>\r\n        <h4>Amount by Category</h4>\r\n        <Pie\r\n          data={{\r\n            labels: Object.keys(metrics.byCategory),\r\n            datasets: [{\r\n              data: Object.values(metrics.byCategory),\r\n              backgroundColor: ['#3b82f6', '#10b981', '#f59e42', '#f43f5e', '#6366f1', '#fef9c3'],\r\n            }]\r\n          }}\r\n          options={{ plugins: { legend: { position: 'bottom' } } }}\r\n        />\r\n      </div>\r\n      <div style={{ flex: 1 }}>\r\n        <h4>Amount by Expense Type</h4>\r\n        <Bar\r\n          data={{\r\n            labels: Object.keys(metrics.byExpenseType),\r\n            datasets: [{\r\n              label: 'Amount',\r\n              data: Object.values(metrics.byExpenseType),\r\n              backgroundColor: '#3b82f6',\r\n            }]\r\n          }}\r\n          options={{\r\n            plugins: { legend: { display: false } },\r\n            scales: { y: { beginAtZero: true } }\r\n          }}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n \r\n  const renderRecentTransactions = (data) => (\r\n    <div style={{ marginBottom: 24 }}>\r\n      <h4>Recent Transactions</h4>\r\n      <div style={{ display: 'flex', gap: 16, flexWrap: 'wrap' }}>\r\n        {data.slice(0, 5).map((row, idx) => (\r\n          <div key={idx} style={{\r\n            background: '#fff', border: '1px solid #eee', borderRadius: 8, padding: 14, minWidth: 180, boxShadow: '0 2px 8px #f3f4f6'\r\n          }}>\r\n            <div style={{ fontWeight: 600 }}>{row.Category || 'Uncategorized'}</div>\r\n            <div style={{ color: '#3b82f6', fontSize: 18 }}>{Number(row.Amount || 0).toLocaleString()}</div>\r\n            <div style={{ fontSize: 12, color: '#666' }}>{row.ExpenseType || 'Expense'} | {row.Date || row.TxnDate}</div>\r\n            <div style={{ fontSize: 12, color: '#888' }}>{row.Note || row.Description}</div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n \r\n  // Helper to extract initial amount from uploaded Excel data\r\nconst getInitialAmountFromExcel = (data) => {\r\n  if (!data || !data.length) return 0;\r\n  // Look for a row with Category: \"Initial\" or ExpenseType: \"Initial\"\r\n  const initialRow = data.find(\r\n    row =>\r\n      (row.Category && row.Category.toLowerCase() === 'initial') ||\r\n      (row.ExpenseType && row.ExpenseType.toLowerCase() === 'initial')\r\n  );\r\n  if (initialRow) {\r\n    return Number(initialRow.Amount || 0);\r\n  }\r\n  // Optionally, fallback to first row if you want\r\n  // return Number(data[0].Amount || 0);\r\n  return 0;\r\n};\r\n \r\n  const getAmountBreakdown = (data) => {\r\n    // Dynamically get initial amount from Excel\r\n    const initialAmount = getInitialAmountFromExcel(data);\r\n \r\n    let totalExpenses = 0;\r\n    let totalIncome = 0;\r\n    const expenseDetails = {};\r\n    const incomeDetails = {};\r\n \r\n    data.forEach(row => {\r\n      // Skip initial amount row from expense/income calculation\r\n      const isInitial =\r\n        (row.Category && row.Category.toLowerCase() === 'initial') ||\r\n        (row.ExpenseType && row.ExpenseType.toLowerCase() === 'initial');\r\n      if (isInitial) return;\r\n \r\n      const amt = Number(row.Amount || 0);\r\n      const type = (row.Category || '').toLowerCase();\r\n      const expType = row.ExpenseType || 'Expense';\r\n \r\n      if (type === 'expense' || expType.toLowerCase() === 'expense') {\r\n        totalExpenses += amt;\r\n        expenseDetails[expType] = (expenseDetails[expType] || 0) + amt;\r\n      } else if (type === 'receipt' || expType.toLowerCase() === 'receipt' || expType.toLowerCase() === 'income') {\r\n        totalIncome += amt;\r\n        incomeDetails[expType] = (incomeDetails[expType] || 0) + amt;\r\n      }\r\n    });\r\n \r\n    const remaining = initialAmount + totalIncome - totalExpenses;\r\n    return { initialAmount, totalExpenses, totalIncome, remaining, expenseDetails, incomeDetails };\r\n};\r\n \r\n  return (\r\n    <>\r\n      <Header isLoggedIn={isLoggedIn} onLogout={onLogout} />\r\n      {view === 'organizations' && (\r\n        <OrganizationSelector\r\n          organizations={organizations}\r\n          onSelect={handleOrgSelect}\r\n        />\r\n      )}\r\n \r\n      {view === 'project' && selectedProject && (\r\n        <ProjectDashboard\r\n          project={selectedProject}\r\n          organization={selectedOrg}\r\n          onBack={handleBack}\r\n        />\r\n      )}\r\n \r\n      {view === 'dashboard' && (\r\n        <>\r\n          <CompanyDashboard\r\n            organization={selectedOrg}\r\n            selectedDept={selectedDept}\r\n            onDeptChange={setSelectedDept}\r\n            onProjectSelect={handleProjectSelect}\r\n            onBack={handleBack}\r\n            projects={getFilteredProjects()}\r\n            totals={Object.keys(totals).length ? totals : totals}\r\n            onAddProject={setShowNewProjectForm}\r\n            onFileUpload={handleFileUpload}\r\n          />\r\n          {showNewProjectForm && selectedOrg && (\r\n            <NewProjectModal\r\n              organizationId={selectedOrg.id}\r\n              departments={departments}\r\n              onCreated={handleProjectCreated}\r\n              onCancel={() => setShowNewProjectForm(false)}\r\n            />\r\n          )}\r\n        </>\r\n      )}\r\n \r\n      {/* Amount Breakdown Popup */}\r\n      {showAmountPopup && uploadedData.length > 0 && (\r\n        <AmountBreakdownPopup\r\n          breakdown={getAmountBreakdown(uploadedData)}\r\n          onClose={() => setShowAmountPopup(false)}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n \r\nconst AmountBreakdownPopup = ({ breakdown, onClose }) => (\r\n  <div style={{\r\n    position: 'fixed', top: 0, left: 0, width: '100vw', height: '100vh',\r\n    background: 'rgba(0,0,0,0.35)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 9999\r\n  }}>\r\n    <div style={{\r\n      background: '#fff', borderRadius: 10, padding: 32, minWidth: 340, boxShadow: '0 4px 24px #0002', position: 'relative'\r\n    }}>\r\n      <button\r\n        onClick={onClose}\r\n        style={{\r\n          position: 'absolute', top: 12, right: 16, background: 'none', border: 'none', fontSize: 22, cursor: 'pointer'\r\n        }}\r\n        aria-label=\"Close\"\r\n      >×</button>\r\n      <h2 style={{ marginTop: 0 }}>Total Amount Breakdown</h2>\r\n      <div style={{ marginBottom: 16 }}>\r\n        <b>Initial Amount:</b> ₹{breakdown.initialAmount.toLocaleString()}\r\n      </div>\r\n      <div style={{ marginBottom: 16 }}>\r\n        <b>Total Expenses:</b> ₹{breakdown.totalExpenses.toLocaleString()}\r\n        <ul style={{ margin: '8px 0 0 16px', padding: 0 }}>\r\n          {Object.entries(breakdown.expenseDetails).map(([cat, amt]) => (\r\n            <li key={cat}>{cat}: ₹{amt.toLocaleString()}</li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n      <div style={{ marginBottom: 16 }}>\r\n        <b>Total Income:</b> ₹{breakdown.totalIncome.toLocaleString()}\r\n        <ul style={{ margin: '8px 0 0 16px', padding: 0 }}>\r\n          {Object.entries(breakdown.incomeDetails).map(([cat, amt]) => (\r\n            <li key={cat}>{cat}: ₹{amt.toLocaleString()}</li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n      <div style={{ fontSize: 18, fontWeight: 600, color: '#10b981' }}>\r\n        Remaining Balance: ₹{breakdown.remaining.toLocaleString()}\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n \r\nexport default OrganizationDashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}