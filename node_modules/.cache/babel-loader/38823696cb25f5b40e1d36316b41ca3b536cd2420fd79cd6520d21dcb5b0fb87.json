{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\VivekReddyMeka\\\\Desktop\\\\Accounts_Management\\\\src\\\\Components\\\\Dashboard.jsx\",\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { Building2, Code } from 'lucide-react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport OrganizationSelector from './OrganizationSelector';\nimport CompanyDashboard from './CompanyDashboard';\nimport ProjectDashboard from './ProjectDashboard';\nimport Header from './Header';\nimport '../Styles/Dashboard.css'; // Import the CSS file\nimport * as XLSX from 'xlsx'; // Add at top\nimport { Bar, Pie } from 'react-chartjs-2';\nimport { Chart, ArcElement, BarElement, CategoryScale, LinearScale, Tooltip, Legend } from 'chart.js';\nimport Papa from 'papaparse';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nChart.register(ArcElement, BarElement, CategoryScale, LinearScale, Tooltip, Legend);\nconst API_BASE = 'http://localhost:3001'; // adjust if your server runs elsewhere\n\n// Main Dashboard Component (now loads data from DB via API)\nconst OrganizationDashboard = ({\n  isLoggedIn,\n  onLogout\n}) => {\n  _s2();\n  var _location$state,\n    _location$state2,\n    _s = $RefreshSig$();\n  const location = useLocation();\n  const userEmail = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.userEmail) || '';\n  const organizationId = ((_location$state2 = location.state) === null || _location$state2 === void 0 ? void 0 : _location$state2.organizationId) || null;\n\n  // Load initial view from localStorage, fallback to 'organizations'\n  const [view, setView] = useState(() => localStorage.getItem('dashboardView') || 'organizations');\n  const [selectedOrg, setSelectedOrg] = useState(() => {\n    const org = localStorage.getItem('selectedOrg');\n    return org ? JSON.parse(org) : null;\n  });\n  const [selectedDept, setSelectedDept] = useState(() => localStorage.getItem('selectedDept') || 'all');\n  const [selectedProject, setSelectedProject] = useState(() => {\n    const proj = localStorage.getItem('selectedProject');\n    return proj ? JSON.parse(proj) : null;\n  });\n  const [organizations, setOrganizations] = useState([]);\n  const [rawProjects, setRawProjects] = useState([]); // raw rows from API (contain DepartmentName etc.)\n  const [departments, setDepartments] = useState([]);\n  const [totals, setTotals] = useState({\n    budget: 0,\n    spent: 0,\n    profit: 0,\n    ar: 0,\n    ap: 0,\n    team: 0\n  });\n  const [showNewProjectForm, setShowNewProjectForm] = useState(false);\n  const [uploadedData, setUploadedData] = useState([]);\n  const [projectsFromFile, setProjectsFromFile] = useState([]);\n  const [uploadError, setUploadError] = useState('');\n  const [uploadFileName, setUploadFileName] = useState('');\n  const [showAmountPopup, setShowAmountPopup] = useState(false);\n  const [dateFilter, setDateFilter] = useState({\n    from: '',\n    to: ''\n  });\n  const [showUploadedPreview, setShowUploadedPreview] = useState(false);\n  const navigate = useNavigate(); // Add this line\n\n  // Save view/page state to localStorage whenever it changes\n  useEffect(() => {\n    localStorage.setItem('dashboardView', view);\n  }, [view]);\n  useEffect(() => {\n    localStorage.setItem('selectedOrg', JSON.stringify(selectedOrg));\n  }, [selectedOrg]);\n  useEffect(() => {\n    localStorage.setItem('selectedDept', selectedDept);\n  }, [selectedDept]);\n  useEffect(() => {\n    localStorage.setItem('selectedProject', JSON.stringify(selectedProject));\n  }, [selectedProject]);\n  useEffect(() => {\n    // load organizations list\n    const loadOrgs = async () => {\n      try {\n        const res = await fetch(`${API_BASE}/organizations`);\n        const data = await res.json();\n        const mapped = data.map(o => ({\n          id: o.OrganizationID,\n          name: o.Name,\n          type: o.Type || '',\n          description: o.Description || '',\n          // choose icons/colors by name/type to keep existing UI consistent\n          icon: o.Name && o.Name.toLowerCase().includes('collabridge') ? Code : Building2,\n          color: o.Name && o.Name.toLowerCase().includes('la tierra') ? '#10b981' : '#3b82f6'\n        }));\n        setOrganizations(mapped);\n      } catch (err) {\n        console.error('Error loading organizations:', err);\n      }\n    };\n    loadOrgs();\n  }, []);\n\n  // Auto-select organization based on email domain\n  // useEffect(() => {\n  //   if (!userEmail || !organizations.length) return;\n\n  //   let orgToSelect = null;\n  //   if (userEmail.toLowerCase().endsWith('@collabridge.com')) {\n  //     orgToSelect = organizations.find(o => o.name.toLowerCase().includes('collabridge'));\n  //   } else if (userEmail.toLowerCase().endsWith('@latierra.com')) {\n  //     orgToSelect = organizations.find(o => o.name.toLowerCase().includes('la tierra') || o.name.toLowerCase().includes('buildcraft'));\n  //   }\n\n  //   if (orgToSelect && (!selectedOrg || selectedOrg.id !== orgToSelect.id)) {\n  //     handleOrgSelect(orgToSelect.id);\n  //   }\n  // }, [userEmail, organizations]);\n\n  // Auto-select organization if organizationId is present (DISABLED to always show selector)\n  // useEffect(() => {\n  //   if (!organizationId || !organizations.length) return;\n  //   const orgToSelect = organizations.find(o => o.id === Number(organizationId));\n  //   if (orgToSelect && (!selectedOrg || selectedOrg.id !== orgToSelect.id)) {\n  //     handleOrgSelect(orgToSelect.id);\n  //   }\n  // }, [organizationId, organizations]);\n\n  const handleOrgSelect = async orgId => {\n    setSelectedDept('all');\n    setSelectedProject(null);\n    setView('dashboard');\n\n    // Clear uploaded file state when switching organizations\n    setProjectsFromFile([]);\n    setUploadedData([]);\n    setShowUploadedPreview(false);\n    setUploadFileName('');\n    setUploadError('');\n    try {\n      var _organizations$find, _organizations$find2;\n      // get organization details\n      const orgRes = await fetch(`${API_BASE}/organizations/${orgId}`);\n      const orgData = await orgRes.json();\n\n      // projects for organization\n      const projRes = await fetch(`${API_BASE}/projects?organizationId=${orgId}`);\n      const projRows = await projRes.json();\n\n      // departments list for filters\n      const deptRes = await fetch(`${API_BASE}/departments?organizationId=${orgId}`);\n      const deptRows = await deptRes.json();\n\n      // map project rows to the shape used by UI (keep DepartmentName for filtering)\n      const mappedProjects = (projRows || []).map(p => {\n        const budget = Number(p.Budget || 0);\n        const spent = Number(p.Spending || 0);\n        const profit = Number(p.Profit !== undefined ? p.Profit : budget - spent);\n        return {\n          id: p.ProjectID || p.ProjectId || p.id,\n          name: p.ProjectName || p.Name || '',\n          status: (p.Status || '').toString(),\n          budget,\n          spent,\n          profit,\n          ar: Number(p.AR || 0),\n          // fallback 0, server may not supply project-level AR\n          ap: Number(p.AP !== undefined ? p.AP : spent),\n          // fallback to spent as payable approximation\n          team: Number(p.Team || 0),\n          // not present in DB seed -> 0 unless backend supplies it\n          deadline: p.EndDate || p.deadline || '',\n          departmentName: p.DepartmentName || ''\n        };\n      });\n      setRawProjects(mappedProjects);\n      // set selectedOrg with API info + mapped projects\n      setSelectedOrg({\n        id: orgData.OrganizationID || orgId,\n        name: orgData.Name || '',\n        type: orgData.Type || '',\n        description: orgData.Description || '',\n        projects: mappedProjects,\n        color: ((_organizations$find = organizations.find(o => o.id === orgId)) === null || _organizations$find === void 0 ? void 0 : _organizations$find.color) || '#3b82f6',\n        icon: ((_organizations$find2 = organizations.find(o => o.id === orgId)) === null || _organizations$find2 === void 0 ? void 0 : _organizations$find2.icon) || Building2\n      });\n\n      // normalize departments\n      setDepartments((deptRows || []).map(d => ({\n        id: d.DepartmentID,\n        name: d.Name\n      })));\n\n      // totals: try to use organization dashboard endpoint\n      try {\n        const dashRes = await fetch(`${API_BASE}/organizations/${orgId}/dashboard`);\n        if (dashRes.ok) {\n          const dash = await dashRes.json();\n          setTotals({\n            budget: Number(dash.totalBudget || 0),\n            spent: Number(dash.totalSpending || 0),\n            profit: Number(dash.totalBudget || 0) - Number(dash.totalSpending || 0),\n            ar: Number(dash.totalAR || 0),\n            ap: Number(dash.totalAP || 0),\n            team: mappedProjects.reduce((s, p) => s + (p.team || 0), 0)\n          });\n        } else {\n          // fallback compute from projects\n          computeTotalsFromProjects(mappedProjects);\n        }\n      } catch (err) {\n        computeTotalsFromProjects(mappedProjects);\n      }\n    } catch (err) {\n      console.error('Error selecting organization:', err);\n    }\n  };\n  const computeTotalsFromProjects = projects => {\n    const t = projects.reduce((acc, project) => ({\n      budget: acc.budget + (project.budget || 0),\n      spent: acc.spent + (project.spent || 0),\n      profit: acc.profit + (project.profit || 0),\n      ar: acc.ar + (project.ar || 0),\n      ap: acc.ap + (project.ap || 0),\n      team: acc.team + (project.team || 0)\n    }), {\n      budget: 0,\n      spent: 0,\n      profit: 0,\n      ar: 0,\n      ap: 0,\n      team: 0\n    });\n    setTotals(t);\n  };\n  const handleProjectSelect = project => {\n    // project could be raw project object from projects list\n    setSelectedProject(project);\n    setView('project');\n  };\n  const handleBack = () => {\n    if (view === 'project') {\n      setView('dashboard');\n      setSelectedProject(null);\n    } else {\n      setView('organizations');\n      setSelectedOrg(null);\n      setSelectedDept('all');\n      setRawProjects([]);\n      setDepartments([]);\n      setTotals({\n        budget: 0,\n        spent: 0,\n        profit: 0,\n        ar: 0,\n        ap: 0,\n        team: 0\n      });\n    }\n  };\n  const getFilteredProjects = () => {\n    // If projectsFromFile is present, use it for projects\n    if (projectsFromFile && projectsFromFile.length > 0) {\n      // If no department info, just return all\n      return projectsFromFile;\n    }\n    // Otherwise, use DB data\n    if (!selectedOrg) return [];\n    if (selectedOrg.id === 1 && selectedOrg.projects) {\n      return selectedOrg.projects;\n    }\n    // If no department info, just return all\n    return rawProjects;\n  };\n  const calculateTotals = projects => {\n    return projects.reduce((acc, project) => ({\n      budget: acc.budget + (project.budget || 0),\n      spent: acc.spent + (project.spent || 0),\n      profit: acc.profit + (project.profit || 0),\n      ar: acc.ar + (project.ar || 0),\n      ap: acc.ap + (project.ap || 0),\n      team: acc.team + (project.team || 0)\n    }), {\n      budget: 0,\n      spent: 0,\n      profit: 0,\n      ar: 0,\n      ap: 0,\n      team: 0\n    });\n  };\n\n  // called after a new project is created to refresh\n  const handleProjectCreated = async () => {\n    setShowNewProjectForm(false);\n    if (selectedOrg && selectedOrg.id) {\n      // re-load selected organization data (reuse handleOrgSelect)\n      await handleOrgSelect(selectedOrg.id);\n    }\n  };\n\n  // Inline modal component (no separate NewProjectForm file)\n  const NewProjectModal = ({\n    organizationId,\n    departments = [],\n    onCreated,\n    onCancel\n  }) => {\n    _s();\n    const [form, setForm] = useState({\n      name: '',\n      departmentId: '',\n      startDate: '',\n      endDate: '',\n      budget: '',\n      spending: '',\n      status: 'Not Started',\n      description: ''\n    });\n    const [submitting, setSubmitting] = useState(false);\n    useEffect(() => {\n      const prev = document.body.style.overflow;\n      document.body.style.overflow = 'hidden';\n      const onKey = e => {\n        if (e.key === 'Escape') onCancel && onCancel();\n      };\n      window.addEventListener('keydown', onKey);\n      return () => {\n        document.body.style.overflow = prev;\n        window.removeEventListener('keydown', onKey);\n      };\n    }, [onCancel]);\n    const update = (k, v) => setForm(s => ({\n      ...s,\n      [k]: v\n    }));\n    const handleSubmit = async e => {\n      e.preventDefault();\n      if (submitting) return;\n      setSubmitting(true);\n      const payload = {\n        Name: form.name,\n        DepartmentID: form.departmentId || null,\n        OrganizationID: organizationId || null,\n        StartDate: form.startDate || null,\n        EndDate: form.endDate || null,\n        Budget: form.budget ? parseFloat(form.budget) : 0,\n        Spending: form.spending ? parseFloat(form.spending) : 0,\n        Status: form.status,\n        Description: form.description || null\n      };\n      try {\n        const res = await fetch(`${API_BASE}/projects`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(payload)\n        });\n        if (res.ok) {\n          onCreated && onCreated();\n        } else {\n          const err = await res.json().catch(() => ({}));\n          alert('Failed to create project: ' + (err.error || res.statusText));\n        }\n      } catch (err) {\n        console.error(err);\n        alert('Failed to create project');\n      } finally {\n        setSubmitting(false);\n      }\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      onMouseDown: () => onCancel && onCancel(),\n      style: {\n        position: 'fixed',\n        inset: 0,\n        background: 'rgba(0,0,0,0.45)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 2000\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-panel\",\n        role: \"dialog\",\n        \"aria-modal\": \"true\",\n        onMouseDown: e => e.stopPropagation(),\n        style: {\n          width: 720,\n          maxWidth: '95%',\n          background: '#fff',\n          borderRadius: 8,\n          padding: 20,\n          boxShadow: '0 10px 30px rgba(0,0,0,0.25)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            marginBottom: 12\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            style: {\n              margin: 0\n            },\n            children: \"Create New Project\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => onCancel && onCancel(),\n            \"aria-label\": \"Close\",\n            style: {\n              border: 0,\n              background: 'transparent',\n              fontSize: 20,\n              lineHeight: 1,\n              cursor: 'pointer'\n            },\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'grid',\n              gridTemplateColumns: '1fr 1fr',\n              gap: 12\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Project Name\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 359,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                required: true,\n                value: form.name,\n                onChange: e => update('name', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 360,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 358,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Department\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 364,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                value: form.departmentId,\n                onChange: e => update('departmentId', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"-- none -- (organization-level)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 366,\n                  columnNumber: 19\n                }, this), departments.map(d => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: d.id,\n                  children: d.name\n                }, d.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 367,\n                  columnNumber: 41\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Start Date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 372,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                value: form.startDate,\n                onChange: e => update('startDate', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 373,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"End Date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 377,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                value: form.endDate,\n                onChange: e => update('endDate', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 378,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 376,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Budget\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 382,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                value: form.budget,\n                onChange: e => update('budget', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 383,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 381,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Spending\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 387,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                value: form.spending,\n                onChange: e => update('spending', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 388,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                gridColumn: '1 / -1'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Status\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 392,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                value: form.status,\n                onChange: e => update('status', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"Not Started\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 394,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"In Progress\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 395,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"Completed\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 396,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  children: \"On Hold\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 397,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 393,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                gridColumn: '1 / -1'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  fontSize: 12,\n                  marginBottom: 6\n                },\n                children: \"Description (optional)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 402,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                value: form.description,\n                onChange: e => update('description', e.target.value),\n                style: {\n                  width: '100%',\n                  padding: 8\n                },\n                rows: 3\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 403,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              justifyContent: 'flex-end',\n              gap: 8,\n              marginTop: 16\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => onCancel && onCancel(),\n              style: {\n                padding: '8px 14px'\n              },\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 408,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              disabled: submitting,\n              style: {\n                padding: '8px 14px'\n              },\n              children: submitting ? 'Creatingâ€¦' : 'Create Project'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 409,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 7\n    }, this);\n  };\n  _s(NewProjectModal, \"u1sl/gAALcDAQSDJuWXmQoPxWtI=\");\n  const handleFileUpload = async e => {\n    const file = e.target.files[0];\n    if (!file) return;\n    try {\n      var _parsedData$, _parsedData$2, _parsedData$3, _parsedData$4, _parsedData$5, _parsedData$6;\n      const parsedData = await parseFile(file);\n\n      // Validate organization for all rows\n      const orgIdFromFile = ((_parsedData$ = parsedData[0]) === null || _parsedData$ === void 0 ? void 0 : _parsedData$.OrgId) || ((_parsedData$2 = parsedData[0]) === null || _parsedData$2 === void 0 ? void 0 : _parsedData$2.OrgID) || ((_parsedData$3 = parsedData[0]) === null || _parsedData$3 === void 0 ? void 0 : _parsedData$3.OrganizationID);\n      const orgNameFromFile = ((_parsedData$4 = parsedData[0]) === null || _parsedData$4 === void 0 ? void 0 : _parsedData$4.OrgName) || ((_parsedData$5 = parsedData[0]) === null || _parsedData$5 === void 0 ? void 0 : _parsedData$5.Orgname) || ((_parsedData$6 = parsedData[0]) === null || _parsedData$6 === void 0 ? void 0 : _parsedData$6.OrganizationName);\n\n      // Check if all rows match selectedOrg\n      const invalidRows = parsedData.filter(row => String(row.OrgId || row.OrgID || row.OrganizationID) !== String(selectedOrg.id) || row.OrgName && row.OrgName !== selectedOrg.name);\n      if (invalidRows.length > 0) {\n        setUploadError(`File contains data for a different organization (OrgId: ${orgIdFromFile}, OrgName: ${orgNameFromFile}). Please upload a file for \"${selectedOrg.name}\" only.`);\n        setUploadedData([]);\n        setProjectsFromFile([]);\n        setShowUploadedPreview(false);\n        setUploadFileName('');\n        return;\n      }\n      setUploadedData(parsedData);\n      const groupedProjects = groupProjectsById(parsedData);\n      setProjectsFromFile(groupedProjects);\n      setShowUploadedPreview(true);\n      setUploadFileName(file.name);\n      setUploadError('');\n    } catch (err) {\n      setUploadError('Failed to parse file.');\n    }\n  };\n\n  // Helper function to calculate metrics from Excel data\n  const getExcelMetrics = data => {\n    let totalAmount = 0;\n    const byCategory = {};\n    const byExpenseType = {};\n    data.forEach(row => {\n      const amount = Number(row.Amount || 0);\n      totalAmount += amount;\n      const category = row.Category || 'Uncategorized';\n      byCategory[category] = (byCategory[category] || 0) + amount;\n      const expenseType = row.ExpenseType || 'Expense';\n      byExpenseType[expenseType] = (byExpenseType[expenseType] || 0) + amount;\n    });\n    return {\n      totalAmount,\n      byCategory,\n      byExpenseType\n    };\n  };\n  const handleSaveToDB = async () => {\n    if (!uploadedData.length) return;\n    const res = await fetch(`${API_BASE}/import-transactions`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        rows: uploadedData,\n        uploaderEmail: userEmail,\n        fileName: uploadFileName,\n        organizationId: (selectedOrg === null || selectedOrg === void 0 ? void 0 : selectedOrg.id) || null\n      })\n    });\n    const result = await res.json();\n    alert(result.message || 'Import complete');\n\n    // Clear upload state and reload organization data from DB\n    setShowUploadedPreview(false);\n    setUploadedData([]);\n    setProjectsFromFile([]);\n    setUploadFileName('');\n    setUploadError('');\n    await handleOrgSelect(selectedOrg.id); // Reload from DB\n  };\n\n  // Move this helper function up, before you use it!\n  const getFilteredUploadedData = () => {\n    if (!uploadedData.length) return [];\n    if (!dateFilter.from && !dateFilter.to) return uploadedData;\n    return uploadedData.filter(row => {\n      const rowDate = row.Date || row.TxnDate;\n      if (!rowDate) return false;\n      const d = new Date(rowDate);\n      const from = dateFilter.from ? new Date(dateFilter.from) : null;\n      const to = dateFilter.to ? new Date(dateFilter.to) : null;\n      if (from && d < from) return false;\n      if (to && d > to) return false;\n      return true;\n    });\n  };\n  const filteredExcelData = getFilteredUploadedData();\n  const metrics = getExcelMetrics(filteredExcelData);\n  const renderExcelCards = metrics => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      gap: 24,\n      marginBottom: 24\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        flex: 1,\n        background: '#e0f2fe',\n        padding: 18,\n        borderRadius: 8,\n        cursor: 'pointer'\n      },\n      onClick: () => setShowAmountPopup(true),\n      title: \"Click to view breakdown\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Total Amount\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 528,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: 28,\n          fontWeight: 700\n        },\n        children: metrics.totalAmount.toLocaleString()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 529,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 522,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        flex: 1,\n        background: '#fef9c3',\n        padding: 18,\n        borderRadius: 8\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Categories\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 532,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        style: {\n          margin: 0,\n          padding: 0,\n          listStyle: 'none'\n        },\n        children: Object.entries(metrics.byCategory).map(([cat, amt]) => /*#__PURE__*/_jsxDEV(\"li\", {\n          style: {\n            fontSize: 16\n          },\n          children: [cat, \": \", /*#__PURE__*/_jsxDEV(\"b\", {\n            children: amt.toLocaleString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 535,\n            columnNumber: 59\n          }, this)]\n        }, cat, true, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 533,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 531,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        flex: 1,\n        background: '#dcfce7',\n        padding: 18,\n        borderRadius: 8\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Expense Types\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 540,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        style: {\n          margin: 0,\n          padding: 0,\n          listStyle: 'none'\n        },\n        children: Object.entries(metrics.byExpenseType).map(([type, amt]) => /*#__PURE__*/_jsxDEV(\"li\", {\n          style: {\n            fontSize: 16\n          },\n          children: [type, \": \", /*#__PURE__*/_jsxDEV(\"b\", {\n            children: amt.toLocaleString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 543,\n            columnNumber: 61\n          }, this)]\n        }, type, true, {\n          fileName: _jsxFileName,\n          lineNumber: 543,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 541,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 539,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 521,\n    columnNumber: 5\n  }, this);\n  const renderExcelCharts = metrics => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      gap: 32,\n      marginBottom: 24\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Amount by Category\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 553,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Pie, {\n        data: {\n          labels: Object.keys(metrics.byCategory),\n          datasets: [{\n            data: Object.values(metrics.byCategory),\n            backgroundColor: ['#3b82f6', '#10b981', '#f59e42', '#f43f5e', '#6366f1', '#fef9c3']\n          }]\n        },\n        options: {\n          plugins: {\n            legend: {\n              position: 'bottom'\n            }\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 552,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Amount by Expense Type\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 566,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Bar, {\n        data: {\n          labels: Object.keys(metrics.byExpenseType),\n          datasets: [{\n            label: 'Amount',\n            data: Object.values(metrics.byExpenseType),\n            backgroundColor: '#3b82f6'\n          }]\n        },\n        options: {\n          plugins: {\n            legend: {\n              display: false\n            }\n          },\n          scales: {\n            y: {\n              beginAtZero: true\n            }\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 567,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 565,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 551,\n    columnNumber: 5\n  }, this);\n  const renderRecentTransactions = data => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginBottom: 24\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n      children: \"Recent Transactions\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 587,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: 16,\n        flexWrap: 'wrap'\n      },\n      children: data.slice(0, 5).map((row, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          background: '#fff',\n          border: '1px solid #eee',\n          borderRadius: 8,\n          padding: 14,\n          minWidth: 180,\n          boxShadow: '0 2px 8px #f3f4f6'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: 600\n          },\n          children: row.Category || 'Uncategorized'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 593,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: '#3b82f6',\n            fontSize: 18\n          },\n          children: Number(row.Amount || 0).toLocaleString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 594,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: 12,\n            color: '#666'\n          },\n          children: [row.ExpenseType || 'Expense', \" | \", row.Date || row.TxnDate]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 595,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: 12,\n            color: '#888'\n          },\n          children: row.Note || row.Description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 596,\n          columnNumber: 13\n        }, this)]\n      }, idx, true, {\n        fileName: _jsxFileName,\n        lineNumber: 590,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 588,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 586,\n    columnNumber: 5\n  }, this);\n\n  // Helper to extract initial amount from uploaded Excel data\n  const getInitialAmountFromExcel = data => {\n    if (!data || !data.length) return 0;\n    // Look for a row with Category: \"Initial\" or ExpenseType: \"Initial\"\n    const initialRow = data.find(row => row.Category && row.Category.toLowerCase() === 'initial' || row.ExpenseType && row.ExpenseType.toLowerCase() === 'initial');\n    if (initialRow) {\n      return Number(initialRow.Amount || 0);\n    }\n    // Optionally, fallback to first row if you want\n    // return Number(data[0].Amount || 0);\n    return 0;\n  };\n  const getAmountBreakdown = data => {\n    // Dynamically get initial amount from Excel\n    const initialAmount = getInitialAmountFromExcel(data);\n    let totalExpenses = 0;\n    let totalIncome = 0;\n    const expenseDetails = {};\n    const incomeDetails = {};\n    data.forEach(row => {\n      // Skip initial amount row from expense/income calculation\n      const isInitial = row.Category && row.Category.toLowerCase() === 'initial' || row.ExpenseType && row.ExpenseType.toLowerCase() === 'initial';\n      if (isInitial) return;\n      const amt = Number(row.Amount || 0);\n      const type = (row.Category || '').toLowerCase();\n      const expType = row.ExpenseType || 'Expense';\n      if (type === 'expense' || expType.toLowerCase() === 'expense') {\n        totalExpenses += amt;\n        expenseDetails[expType] = (expenseDetails[expType] || 0) + amt;\n      } else if (type === 'receipt' || expType.toLowerCase() === 'receipt' || expType.toLowerCase() === 'income') {\n        totalIncome += amt;\n        incomeDetails[expType] = (incomeDetails[expType] || 0) + amt;\n      }\n    });\n    const remaining = initialAmount + totalIncome - totalExpenses;\n    return {\n      initialAmount,\n      totalExpenses,\n      totalIncome,\n      remaining,\n      expenseDetails,\n      incomeDetails\n    };\n  };\n\n  // Helper to group non-project transactions\n  function getOtherTransactions(data) {\n    return data.filter(row => !row.ProjectID && !row.ProjectName && !row.projectId && !row.projectName);\n  }\n\n  // Helper to create \"Other\" pseudo-project\n  function getOtherProject(data) {\n    const otherTxs = getOtherTransactions(data);\n    if (!otherTxs.length) return null;\n    const ar = otherTxs.filter(tx => (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'income' || (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'receipt').reduce((sum, tx) => sum + Number(tx.Amount || tx.amount || 0), 0);\n    const ap = otherTxs.filter(tx => (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'expense').reduce((sum, tx) => sum + Number(tx.Amount || tx.amount || 0), 0);\n    return {\n      id: 'other',\n      name: 'Other (Non-Project)',\n      transactions: otherTxs,\n      ar,\n      ap,\n      profit: ar - ap\n    };\n  }\n  const projectsData = projectsFromFile.length > 0 ? projectsFromFile : getFilteredProjects();\n  let dashboardProjects = [...projectsData];\n\n  // If uploadedData or API data contains non-project transactions, add \"Other\" pseudo-project\n  if (uploadedData.length > 0) {\n    const otherProject = getOtherProject(uploadedData);\n    if (otherProject) dashboardProjects.push(otherProject);\n  } else if (selectedOrg && selectedOrg.projects) {\n    // If using API data, you may need to fetch organization-level transactions and add here\n    // Example: selectedOrg.organizationTransactions (if available from API)\n    // const otherProject = getOtherProject(selectedOrg.organizationTransactions || []);\n    // if (otherProject) dashboardProjects.push(otherProject);\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      isLoggedIn: isLoggedIn,\n      onLogout: onLogout\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 694,\n      columnNumber: 7\n    }, this), view === 'organizations' && /*#__PURE__*/_jsxDEV(OrganizationSelector, {\n      organizations: organizations,\n      onSelect: handleOrgSelect\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 696,\n      columnNumber: 9\n    }, this), view === 'project' && selectedProject && /*#__PURE__*/_jsxDEV(ProjectDashboard, {\n      project: selectedProject,\n      organization: selectedOrg,\n      onBack: handleBack\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 703,\n      columnNumber: 9\n    }, this), view === 'dashboard' && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(CompanyDashboard, {\n        organization: selectedOrg,\n        selectedDept: selectedDept,\n        onDeptChange: setSelectedDept,\n        onProjectSelect: handleProjectSelect,\n        onAddProject: setShowNewProjectForm,\n        onFileUpload: handleFileUpload,\n        onBack: handleBack,\n        projects: dashboardProjects,\n        totals: calculateTotals(dashboardProjects)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 712,\n        columnNumber: 11\n      }, this), showNewProjectForm && selectedOrg && /*#__PURE__*/_jsxDEV(NewProjectModal, {\n        organizationId: selectedOrg.id,\n        departments: departments,\n        onCreated: handleProjectCreated,\n        onCancel: () => setShowNewProjectForm(false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 724,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true), showAmountPopup && uploadedData.length > 0 && /*#__PURE__*/_jsxDEV(AmountBreakdownPopup, {\n      breakdown: getAmountBreakdown(uploadedData),\n      onClose: () => setShowAmountPopup(false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 736,\n      columnNumber: 9\n    }, this), uploadError && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        color: 'red',\n        margin: '12px 0',\n        fontWeight: 600\n      },\n      children: uploadError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 742,\n      columnNumber: 3\n    }, this)]\n  }, void 0, true);\n};\n_s2(OrganizationDashboard, \"b92WA1MT+VmeTG8NIoaveSOpwXg=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = OrganizationDashboard;\nconst AmountBreakdownPopup = ({\n  breakdown,\n  onClose\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  style: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: '100vw',\n    height: '100vh',\n    background: 'rgba(0,0,0,0.35)',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    zIndex: 9999\n  },\n  children: /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      background: '#fff',\n      borderRadius: 10,\n      padding: 32,\n      minWidth: 340,\n      boxShadow: '0 4px 24px #0002',\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: onClose,\n      style: {\n        position: 'absolute',\n        top: 12,\n        right: 16,\n        background: 'none',\n        border: 'none',\n        fontSize: 22,\n        cursor: 'pointer'\n      },\n      \"aria-label\": \"Close\",\n      children: \"\\xD7\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 758,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        marginTop: 0\n      },\n      children: \"Total Amount Breakdown\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 765,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"Initial Amount:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 767,\n        columnNumber: 9\n      }, this), \" \\u20B9\", breakdown.initialAmount.toLocaleString()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 766,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"Total Expenses:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 770,\n        columnNumber: 9\n      }, this), \" \\u20B9\", breakdown.totalExpenses.toLocaleString(), /*#__PURE__*/_jsxDEV(\"ul\", {\n        style: {\n          margin: '8px 0 0 16px',\n          padding: 0\n        },\n        children: Object.entries(breakdown.expenseDetails).map(([cat, amt]) => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [cat, \": \\u20B9\", amt.toLocaleString()]\n        }, cat, true, {\n          fileName: _jsxFileName,\n          lineNumber: 773,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 771,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 769,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"Total Income:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 778,\n        columnNumber: 9\n      }, this), \" \\u20B9\", breakdown.totalIncome.toLocaleString(), /*#__PURE__*/_jsxDEV(\"ul\", {\n        style: {\n          margin: '8px 0 0 16px',\n          padding: 0\n        },\n        children: Object.entries(breakdown.incomeDetails).map(([cat, amt]) => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [cat, \": \\u20B9\", amt.toLocaleString()]\n        }, cat, true, {\n          fileName: _jsxFileName,\n          lineNumber: 781,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 779,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 777,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        fontSize: 18,\n        fontWeight: 600,\n        color: '#10b981'\n      },\n      children: [\"Remaining Balance: \\u20B9\", breakdown.remaining.toLocaleString()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 785,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 755,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 751,\n  columnNumber: 3\n}, this);\n_c2 = AmountBreakdownPopup;\nconst parseFile = async file => {\n  // CSV\n  if (file.name.endsWith('.csv')) {\n    return new Promise((resolve, reject) => {\n      Papa.parse(file, {\n        header: true,\n        skipEmptyLines: true,\n        complete: results => resolve(results.data),\n        error: err => reject(err)\n      });\n    });\n  }\n  // Excel (xlsx/xls)\n  if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = e => {\n        const data = new Uint8Array(e.target.result);\n        const workbook = XLSX.read(data, {\n          type: 'array'\n        });\n        const sheetName = workbook.SheetNames[0];\n        const worksheet = workbook.Sheets[sheetName];\n        const json = XLSX.utils.sheet_to_json(worksheet, {\n          defval: ''\n        });\n        resolve(json);\n      };\n      reader.onerror = reject;\n      reader.readAsArrayBuffer(file);\n    });\n  }\n  throw new Error('Unsupported file type');\n};\nfunction groupProjectsById(data) {\n  const projectsMap = {};\n  data.forEach(row => {\n    const pid = row.ProjectID || row.projectId || row.project_id || row.ProjectName || row.projectName;\n    if (!pid) return;\n    if (!projectsMap[pid]) {\n      projectsMap[pid] = {\n        id: pid,\n        name: row.ProjectName || row.projectName || `Project ${pid}`,\n        transactions: [],\n        ar: 0,\n        ap: 0,\n        profit: 0\n      };\n    }\n    projectsMap[pid].transactions.push(row);\n  });\n  // Calculate AR, AP, Profit for each project\n  Object.values(projectsMap).forEach(project => {\n    project.ar = project.transactions.filter(tx => (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'income' || (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'receipt').reduce((sum, tx) => sum + Number(tx.Amount || tx.amount || 0), 0);\n    project.ap = project.transactions.filter(tx => (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'expense').reduce((sum, tx) => sum + Number(tx.Amount || tx.amount || 0), 0);\n    project.profit = project.ar - project.ap;\n  });\n  return Object.values(projectsMap);\n}\nexport default OrganizationDashboard;\nvar _c, _c2;\n$RefreshReg$(_c, \"OrganizationDashboard\");\n$RefreshReg$(_c2, \"AmountBreakdownPopup\");","map":{"version":3,"names":["React","useState","useEffect","Building2","Code","useNavigate","useLocation","OrganizationSelector","CompanyDashboard","ProjectDashboard","Header","XLSX","Bar","Pie","Chart","ArcElement","BarElement","CategoryScale","LinearScale","Tooltip","Legend","Papa","jsxDEV","_jsxDEV","Fragment","_Fragment","register","API_BASE","OrganizationDashboard","isLoggedIn","onLogout","_s2","_location$state","_location$state2","_s","$RefreshSig$","location","userEmail","state","organizationId","view","setView","localStorage","getItem","selectedOrg","setSelectedOrg","org","JSON","parse","selectedDept","setSelectedDept","selectedProject","setSelectedProject","proj","organizations","setOrganizations","rawProjects","setRawProjects","departments","setDepartments","totals","setTotals","budget","spent","profit","ar","ap","team","showNewProjectForm","setShowNewProjectForm","uploadedData","setUploadedData","projectsFromFile","setProjectsFromFile","uploadError","setUploadError","uploadFileName","setUploadFileName","showAmountPopup","setShowAmountPopup","dateFilter","setDateFilter","from","to","showUploadedPreview","setShowUploadedPreview","navigate","setItem","stringify","loadOrgs","res","fetch","data","json","mapped","map","o","id","OrganizationID","name","Name","type","Type","description","Description","icon","toLowerCase","includes","color","err","console","error","handleOrgSelect","orgId","_organizations$find","_organizations$find2","orgRes","orgData","projRes","projRows","deptRes","deptRows","mappedProjects","p","Number","Budget","Spending","Profit","undefined","ProjectID","ProjectId","ProjectName","status","Status","toString","AR","AP","Team","deadline","EndDate","departmentName","DepartmentName","projects","find","d","DepartmentID","dashRes","ok","dash","totalBudget","totalSpending","totalAR","totalAP","reduce","s","computeTotalsFromProjects","t","acc","project","handleProjectSelect","handleBack","getFilteredProjects","length","calculateTotals","handleProjectCreated","NewProjectModal","onCreated","onCancel","form","setForm","departmentId","startDate","endDate","spending","submitting","setSubmitting","prev","document","body","style","overflow","onKey","e","key","window","addEventListener","removeEventListener","update","k","v","handleSubmit","preventDefault","payload","StartDate","parseFloat","method","headers","catch","alert","statusText","className","onMouseDown","position","inset","background","display","alignItems","justifyContent","zIndex","children","role","stopPropagation","width","maxWidth","borderRadius","padding","boxShadow","marginBottom","margin","fileName","_jsxFileName","lineNumber","columnNumber","onClick","border","fontSize","lineHeight","cursor","onSubmit","gridTemplateColumns","gap","required","value","onChange","target","gridColumn","rows","marginTop","disabled","handleFileUpload","file","files","_parsedData$","_parsedData$2","_parsedData$3","_parsedData$4","_parsedData$5","_parsedData$6","parsedData","parseFile","orgIdFromFile","OrgId","OrgID","orgNameFromFile","OrgName","Orgname","OrganizationName","invalidRows","filter","row","String","groupedProjects","groupProjectsById","getExcelMetrics","totalAmount","byCategory","byExpenseType","forEach","amount","Amount","category","Category","expenseType","ExpenseType","handleSaveToDB","uploaderEmail","result","message","getFilteredUploadedData","rowDate","Date","TxnDate","filteredExcelData","metrics","renderExcelCards","flex","title","fontWeight","toLocaleString","listStyle","Object","entries","cat","amt","renderExcelCharts","labels","keys","datasets","values","backgroundColor","options","plugins","legend","label","scales","y","beginAtZero","renderRecentTransactions","flexWrap","slice","idx","minWidth","Note","getInitialAmountFromExcel","initialRow","getAmountBreakdown","initialAmount","totalExpenses","totalIncome","expenseDetails","incomeDetails","isInitial","expType","remaining","getOtherTransactions","projectId","projectName","getOtherProject","otherTxs","tx","sum","transactions","projectsData","dashboardProjects","otherProject","push","onSelect","organization","onBack","onDeptChange","onProjectSelect","onAddProject","onFileUpload","AmountBreakdownPopup","breakdown","onClose","_c","top","left","height","right","_c2","endsWith","Promise","resolve","reject","header","skipEmptyLines","complete","results","reader","FileReader","onload","Uint8Array","workbook","read","sheetName","SheetNames","worksheet","Sheets","utils","sheet_to_json","defval","onerror","readAsArrayBuffer","Error","projectsMap","pid","project_id","$RefreshReg$"],"sources":["C:/Users/VivekReddyMeka/Desktop/Accounts_Management/src/Components/Dashboard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Building2, Code } from 'lucide-react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport OrganizationSelector from './OrganizationSelector';\r\nimport CompanyDashboard from './CompanyDashboard';\r\nimport ProjectDashboard from './ProjectDashboard';\r\nimport Header from './Header';\r\nimport '../Styles/Dashboard.css'; // Import the CSS file\r\nimport * as XLSX from 'xlsx'; // Add at top\r\nimport { Bar, Pie } from 'react-chartjs-2';\r\nimport { Chart, ArcElement, BarElement, CategoryScale, LinearScale, Tooltip, Legend } from 'chart.js';\r\nimport Papa from 'papaparse';\r\n\r\nChart.register(ArcElement, BarElement, CategoryScale, LinearScale, Tooltip, Legend);\r\n \r\nconst API_BASE = 'http://localhost:3001'; // adjust if your server runs elsewhere\r\n \r\n// Main Dashboard Component (now loads data from DB via API)\r\nconst OrganizationDashboard = ({ isLoggedIn, onLogout }) => {\r\n  const location = useLocation();\r\n  const userEmail = location.state?.userEmail || '';\r\n  const organizationId = location.state?.organizationId || null;\r\n \r\n  // Load initial view from localStorage, fallback to 'organizations'\r\n  const [view, setView] = useState(() => localStorage.getItem('dashboardView') || 'organizations');\r\n  const [selectedOrg, setSelectedOrg] = useState(() => {\r\n    const org = localStorage.getItem('selectedOrg');\r\n    return org ? JSON.parse(org) : null;\r\n  });\r\n  const [selectedDept, setSelectedDept] = useState(() => localStorage.getItem('selectedDept') || 'all');\r\n  const [selectedProject, setSelectedProject] = useState(() => {\r\n    const proj = localStorage.getItem('selectedProject');\r\n    return proj ? JSON.parse(proj) : null;\r\n  });\r\n  const [organizations, setOrganizations] = useState([]);\r\n  const [rawProjects, setRawProjects] = useState([]); // raw rows from API (contain DepartmentName etc.)\r\n  const [departments, setDepartments] = useState([]);\r\n  const [totals, setTotals] = useState({ budget:0, spent:0, profit:0, ar:0, ap:0, team:0 });\r\n  const [showNewProjectForm, setShowNewProjectForm] = useState(false);\r\n  const [uploadedData, setUploadedData] = useState([]);\r\n  const [projectsFromFile, setProjectsFromFile] = useState([]);\r\n  const [uploadError, setUploadError] = useState('');\r\n  const [uploadFileName, setUploadFileName] = useState('');\r\n  const [showAmountPopup, setShowAmountPopup] = useState(false);\r\n  const [dateFilter, setDateFilter] = useState({ from: '', to: '' });\r\n  const [showUploadedPreview, setShowUploadedPreview] = useState(false);\r\n  const navigate = useNavigate(); // Add this line\r\n \r\n  // Save view/page state to localStorage whenever it changes\r\n  useEffect(() => {\r\n    localStorage.setItem('dashboardView', view);\r\n  }, [view]);\r\n  useEffect(() => {\r\n    localStorage.setItem('selectedOrg', JSON.stringify(selectedOrg));\r\n  }, [selectedOrg]);\r\n  useEffect(() => {\r\n    localStorage.setItem('selectedDept', selectedDept);\r\n  }, [selectedDept]);\r\n  useEffect(() => {\r\n    localStorage.setItem('selectedProject', JSON.stringify(selectedProject));\r\n  }, [selectedProject]);\r\n \r\n  useEffect(() => {\r\n    // load organizations list\r\n    const loadOrgs = async () => {\r\n      try {\r\n        const res = await fetch(`${API_BASE}/organizations`);\r\n        const data = await res.json();\r\n        const mapped = data.map(o => ({\r\n          id: o.OrganizationID,\r\n          name: o.Name,\r\n          type: o.Type || '',\r\n          description: o.Description || '',\r\n          // choose icons/colors by name/type to keep existing UI consistent\r\n          icon: o.Name && o.Name.toLowerCase().includes('collabridge') ? Code : Building2,\r\n          color: o.Name && o.Name.toLowerCase().includes('la tierra') ? '#10b981' : '#3b82f6'\r\n        }));\r\n        setOrganizations(mapped);\r\n      } catch (err) {\r\n        console.error('Error loading organizations:', err);\r\n      }\r\n    };\r\n    loadOrgs();\r\n  }, []);\r\n \r\n  // Auto-select organization based on email domain\r\n  // useEffect(() => {\r\n  //   if (!userEmail || !organizations.length) return;\r\n \r\n  //   let orgToSelect = null;\r\n  //   if (userEmail.toLowerCase().endsWith('@collabridge.com')) {\r\n  //     orgToSelect = organizations.find(o => o.name.toLowerCase().includes('collabridge'));\r\n  //   } else if (userEmail.toLowerCase().endsWith('@latierra.com')) {\r\n  //     orgToSelect = organizations.find(o => o.name.toLowerCase().includes('la tierra') || o.name.toLowerCase().includes('buildcraft'));\r\n  //   }\r\n \r\n  //   if (orgToSelect && (!selectedOrg || selectedOrg.id !== orgToSelect.id)) {\r\n  //     handleOrgSelect(orgToSelect.id);\r\n  //   }\r\n  // }, [userEmail, organizations]);\r\n \r\n  // Auto-select organization if organizationId is present (DISABLED to always show selector)\r\n  // useEffect(() => {\r\n  //   if (!organizationId || !organizations.length) return;\r\n  //   const orgToSelect = organizations.find(o => o.id === Number(organizationId));\r\n  //   if (orgToSelect && (!selectedOrg || selectedOrg.id !== orgToSelect.id)) {\r\n  //     handleOrgSelect(orgToSelect.id);\r\n  //   }\r\n  // }, [organizationId, organizations]);\r\n \r\n  const handleOrgSelect = async (orgId) => {\r\n    setSelectedDept('all');\r\n    setSelectedProject(null);\r\n    setView('dashboard');\r\n\r\n    // Clear uploaded file state when switching organizations\r\n    setProjectsFromFile([]);\r\n    setUploadedData([]);\r\n    setShowUploadedPreview(false);\r\n    setUploadFileName('');\r\n    setUploadError('');\r\n\r\n    try {\r\n      // get organization details\r\n      const orgRes = await fetch(`${API_BASE}/organizations/${orgId}`);\r\n      const orgData = await orgRes.json();\r\n \r\n      // projects for organization\r\n      const projRes = await fetch(`${API_BASE}/projects?organizationId=${orgId}`);\r\n      const projRows = await projRes.json();\r\n \r\n      // departments list for filters\r\n      const deptRes = await fetch(`${API_BASE}/departments?organizationId=${orgId}`);\r\n      const deptRows = await deptRes.json();\r\n \r\n      // map project rows to the shape used by UI (keep DepartmentName for filtering)\r\n      const mappedProjects = (projRows || []).map(p => {\r\n        const budget = Number(p.Budget || 0);\r\n        const spent = Number(p.Spending || 0);\r\n        const profit = Number(p.Profit !== undefined ? p.Profit : (budget - spent));\r\n        return {\r\n          id: p.ProjectID || p.ProjectId || p.id,\r\n          name: p.ProjectName || p.Name || '',\r\n          status: (p.Status || '').toString(),\r\n          budget,\r\n          spent,\r\n          profit,\r\n          ar: Number(p.AR || 0),            // fallback 0, server may not supply project-level AR\r\n          ap: Number(p.AP !== undefined ? p.AP : spent), // fallback to spent as payable approximation\r\n          team: Number(p.Team || 0),        // not present in DB seed -> 0 unless backend supplies it\r\n          deadline: p.EndDate || p.deadline || '',\r\n          departmentName: p.DepartmentName || ''\r\n        };\r\n      });\r\n \r\n      setRawProjects(mappedProjects);\r\n      // set selectedOrg with API info + mapped projects\r\n      setSelectedOrg({\r\n        id: orgData.OrganizationID || orgId,\r\n        name: orgData.Name || '',\r\n        type: orgData.Type || '',\r\n        description: orgData.Description || '',\r\n        projects: mappedProjects,\r\n        color: organizations.find(o => o.id === orgId)?.color || '#3b82f6',\r\n        icon: organizations.find(o => o.id === orgId)?.icon || Building2\r\n      });\r\n \r\n      // normalize departments\r\n      setDepartments((deptRows || []).map(d => ({ id: d.DepartmentID, name: d.Name })));\r\n \r\n      // totals: try to use organization dashboard endpoint\r\n      try {\r\n        const dashRes = await fetch(`${API_BASE}/organizations/${orgId}/dashboard`);\r\n        if (dashRes.ok) {\r\n          const dash = await dashRes.json();\r\n          setTotals({\r\n            budget: Number(dash.totalBudget || 0),\r\n            spent: Number(dash.totalSpending || 0),\r\n            profit: Number(dash.totalBudget || 0) - Number(dash.totalSpending || 0),\r\n            ar: Number(dash.totalAR || 0),\r\n            ap: Number(dash.totalAP || 0),\r\n            team: mappedProjects.reduce((s,p) => s + (p.team||0), 0)\r\n          });\r\n        } else {\r\n          // fallback compute from projects\r\n          computeTotalsFromProjects(mappedProjects);\r\n        }\r\n      } catch (err) {\r\n        computeTotalsFromProjects(mappedProjects);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error selecting organization:', err);\r\n    }\r\n  };\r\n \r\n  const computeTotalsFromProjects = (projects) => {\r\n    const t = projects.reduce((acc, project) => ({\r\n      budget: acc.budget + (project.budget || 0),\r\n      spent: acc.spent + (project.spent || 0),\r\n      profit: acc.profit + (project.profit || 0),\r\n      ar: acc.ar + (project.ar || 0),\r\n      ap: acc.ap + (project.ap || 0),\r\n      team: acc.team + (project.team || 0)\r\n    }), { budget:0, spent:0, profit:0, ar:0, ap:0, team:0 });\r\n    setTotals(t);\r\n  };\r\n \r\n  const handleProjectSelect = (project) => {\r\n    // project could be raw project object from projects list\r\n    setSelectedProject(project);\r\n    setView('project');\r\n  };\r\n \r\n  const handleBack = () => {\r\n    if (view === 'project') {\r\n      setView('dashboard');\r\n      setSelectedProject(null);\r\n    } else {\r\n      setView('organizations');\r\n      setSelectedOrg(null);\r\n      setSelectedDept('all');\r\n      setRawProjects([]);\r\n      setDepartments([]);\r\n      setTotals({ budget:0, spent:0, profit:0, ar:0, ap:0, team:0 });\r\n    }\r\n  };\r\n \r\n  const getFilteredProjects = () => {\r\n    // If projectsFromFile is present, use it for projects\r\n    if (projectsFromFile && projectsFromFile.length > 0) {\r\n      // If no department info, just return all\r\n      return projectsFromFile;\r\n    }\r\n    // Otherwise, use DB data\r\n    if (!selectedOrg) return [];\r\n    if (selectedOrg.id === 1 && selectedOrg.projects) {\r\n      return selectedOrg.projects;\r\n    }\r\n    // If no department info, just return all\r\n    return rawProjects;\r\n  };\r\n \r\n  const calculateTotals = (projects) => {\r\n    return projects.reduce((acc, project) => ({\r\n      budget: acc.budget + (project.budget || 0),\r\n      spent: acc.spent + (project.spent || 0),\r\n      profit: acc.profit + (project.profit || 0),\r\n      ar: acc.ar + (project.ar || 0),\r\n      ap: acc.ap + (project.ap || 0),\r\n      team: acc.team + (project.team || 0)\r\n    }), { budget: 0, spent: 0, profit: 0, ar: 0, ap: 0, team: 0 });\r\n  };\r\n \r\n  // called after a new project is created to refresh\r\n  const handleProjectCreated = async () => {\r\n    setShowNewProjectForm(false);\r\n    if (selectedOrg && selectedOrg.id) {\r\n      // re-load selected organization data (reuse handleOrgSelect)\r\n      await handleOrgSelect(selectedOrg.id);\r\n    }\r\n  };\r\n \r\n  // Inline modal component (no separate NewProjectForm file)\r\n  const NewProjectModal = ({ organizationId, departments = [], onCreated, onCancel }) => {\r\n    const [form, setForm] = useState({\r\n      name: '',\r\n      departmentId: '',\r\n      startDate: '',\r\n      endDate: '',\r\n      budget: '',\r\n      spending: '',\r\n      status: 'Not Started',\r\n      description: ''\r\n    });\r\n    const [submitting, setSubmitting] = useState(false);\r\n \r\n    useEffect(() => {\r\n      const prev = document.body.style.overflow;\r\n      document.body.style.overflow = 'hidden';\r\n      const onKey = (e) => { if (e.key === 'Escape') onCancel && onCancel(); };\r\n      window.addEventListener('keydown', onKey);\r\n      return () => {\r\n        document.body.style.overflow = prev;\r\n        window.removeEventListener('keydown', onKey);\r\n      };\r\n    }, [onCancel]);\r\n \r\n    const update = (k, v) => setForm(s => ({ ...s, [k]: v }));\r\n \r\n    const handleSubmit = async (e) => {\r\n      e.preventDefault();\r\n      if (submitting) return;\r\n      setSubmitting(true);\r\n      const payload = {\r\n        Name: form.name,\r\n        DepartmentID: form.departmentId || null,\r\n        OrganizationID: organizationId || null,\r\n        StartDate: form.startDate || null,\r\n        EndDate: form.endDate || null,\r\n        Budget: form.budget ? parseFloat(form.budget) : 0,\r\n        Spending: form.spending ? parseFloat(form.spending) : 0,\r\n        Status: form.status,\r\n        Description: form.description || null\r\n      };\r\n      try {\r\n        const res = await fetch(`${API_BASE}/projects`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(payload)\r\n        });\r\n        if (res.ok) {\r\n          onCreated && onCreated();\r\n        } else {\r\n          const err = await res.json().catch(()=>({}));\r\n          alert('Failed to create project: ' + (err.error || res.statusText));\r\n        }\r\n      } catch (err) {\r\n        console.error(err);\r\n        alert('Failed to create project');\r\n      } finally {\r\n        setSubmitting(false);\r\n      }\r\n    };\r\n \r\n    return (\r\n      <div\r\n        className=\"modal-overlay\"\r\n        onMouseDown={() => onCancel && onCancel()}\r\n        style={{\r\n          position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.45)', display: 'flex',\r\n          alignItems: 'center', justifyContent: 'center', zIndex: 2000\r\n        }}\r\n      >\r\n        <div\r\n          className=\"modal-panel\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => e.stopPropagation()}\r\n          style={{\r\n            width: 720, maxWidth: '95%', background: '#fff', borderRadius: 8, padding: 20,\r\n            boxShadow: '0 10px 30px rgba(0,0,0,0.25)'\r\n          }}\r\n        >\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 12 }}>\r\n            <h2 style={{ margin: 0 }}>Create New Project</h2>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => onCancel && onCancel()}\r\n              aria-label=\"Close\"\r\n              style={{ border: 0, background: 'transparent', fontSize: 20, lineHeight: 1, cursor: 'pointer' }}\r\n            >\r\n              Ã—\r\n            </button>\r\n          </div>\r\n \r\n          <form onSubmit={handleSubmit}>\r\n            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 12 }}>\r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Project Name</label>\r\n                <input required value={form.name} onChange={e => update('name', e.target.value)} style={{ width: '100%', padding: 8 }} />\r\n              </div>\r\n \r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Department</label>\r\n                <select value={form.departmentId} onChange={e => update('departmentId', e.target.value)} style={{ width: '100%', padding: 8 }}>\r\n                  <option value=\"\">-- none -- (organization-level)</option>\r\n                  {departments.map(d => <option key={d.id} value={d.id}>{d.name}</option>)}\r\n                </select>\r\n              </div>\r\n \r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Start Date</label>\r\n                <input type=\"date\" value={form.startDate} onChange={e => update('startDate', e.target.value)} style={{ width: '100%', padding: 8 }} />\r\n              </div>\r\n \r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>End Date</label>\r\n                <input type=\"date\" value={form.endDate} onChange={e => update('endDate', e.target.value)} style={{ width: '100%', padding: 8 }} />\r\n              </div>\r\n \r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Budget</label>\r\n                <input type=\"number\" value={form.budget} onChange={e => update('budget', e.target.value)} style={{ width: '100%', padding: 8 }} />\r\n              </div>\r\n \r\n              <div>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Spending</label>\r\n                <input type=\"number\" value={form.spending} onChange={e => update('spending', e.target.value)} style={{ width: '100%', padding: 8 }} />\r\n              </div>\r\n \r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Status</label>\r\n                <select value={form.status} onChange={e => update('status', e.target.value)} style={{ width: '100%', padding: 8 }}>\r\n                  <option>Not Started</option>\r\n                  <option>In Progress</option>\r\n                  <option>Completed</option>\r\n                  <option>On Hold</option>\r\n                </select>\r\n              </div>\r\n \r\n              <div style={{ gridColumn: '1 / -1' }}>\r\n                <label style={{ display: 'block', fontSize: 12, marginBottom: 6 }}>Description (optional)</label>\r\n                <textarea value={form.description} onChange={e => update('description', e.target.value)} style={{ width: '100%', padding: 8 }} rows={3} />\r\n              </div>\r\n            </div>\r\n \r\n            <div style={{ display: 'flex', justifyContent: 'flex-end', gap: 8, marginTop: 16 }}>\r\n              <button type=\"button\" onClick={() => onCancel && onCancel()} style={{ padding: '8px 14px' }}>Cancel</button>\r\n              <button type=\"submit\" disabled={submitting} style={{ padding: '8px 14px' }}>\r\n                {submitting ? 'Creatingâ€¦' : 'Create Project'}\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n \r\n  const handleFileUpload = async (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n    try {\r\n      const parsedData = await parseFile(file);\r\n\r\n      // Validate organization for all rows\r\n      const orgIdFromFile = parsedData[0]?.OrgId || parsedData[0]?.OrgID || parsedData[0]?.OrganizationID;\r\n      const orgNameFromFile = parsedData[0]?.OrgName || parsedData[0]?.Orgname || parsedData[0]?.OrganizationName;\r\n\r\n      // Check if all rows match selectedOrg\r\n      const invalidRows = parsedData.filter(row =>\r\n        String(row.OrgId || row.OrgID || row.OrganizationID) !== String(selectedOrg.id) ||\r\n        (row.OrgName && row.OrgName !== selectedOrg.name)\r\n      );\r\n\r\n      if (invalidRows.length > 0) {\r\n        setUploadError(\r\n          `File contains data for a different organization (OrgId: ${orgIdFromFile}, OrgName: ${orgNameFromFile}). Please upload a file for \"${selectedOrg.name}\" only.`\r\n        );\r\n        setUploadedData([]);\r\n        setProjectsFromFile([]);\r\n        setShowUploadedPreview(false);\r\n        setUploadFileName('');\r\n        return;\r\n      }\r\n\r\n      setUploadedData(parsedData);\r\n      const groupedProjects = groupProjectsById(parsedData);\r\n      setProjectsFromFile(groupedProjects);\r\n      setShowUploadedPreview(true);\r\n      setUploadFileName(file.name);\r\n      setUploadError('');\r\n    } catch (err) {\r\n      setUploadError('Failed to parse file.');\r\n    }\r\n  };\r\n \r\n    // Helper function to calculate metrics from Excel data\r\n  const getExcelMetrics = (data) => {\r\n    let totalAmount = 0;\r\n    const byCategory = {};\r\n    const byExpenseType = {};\r\n \r\n    data.forEach(row => {\r\n      const amount = Number(row.Amount || 0);\r\n      totalAmount += amount;\r\n \r\n      const category = row.Category || 'Uncategorized';\r\n      byCategory[category] = (byCategory[category] || 0) + amount;\r\n \r\n      const expenseType = row.ExpenseType || 'Expense';\r\n      byExpenseType[expenseType] = (byExpenseType[expenseType] || 0) + amount;\r\n    });\r\n \r\n    return { totalAmount, byCategory, byExpenseType };\r\n  };\r\n \r\n    const handleSaveToDB = async () => {\r\n      if (!uploadedData.length) return;\r\n      const res = await fetch(`${API_BASE}/import-transactions`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          rows: uploadedData,\r\n          uploaderEmail: userEmail,\r\n          fileName: uploadFileName,\r\n          organizationId: selectedOrg?.id || null\r\n        })\r\n      });\r\n      const result = await res.json();\r\n      alert(result.message || 'Import complete');\r\n\r\n      // Clear upload state and reload organization data from DB\r\n      setShowUploadedPreview(false);\r\n      setUploadedData([]);\r\n      setProjectsFromFile([]);\r\n      setUploadFileName('');\r\n      setUploadError('');\r\n      await handleOrgSelect(selectedOrg.id); // Reload from DB\r\n    };\r\n \r\n  // Move this helper function up, before you use it!\r\n  const getFilteredUploadedData = () => {\r\n    if (!uploadedData.length) return [];\r\n    if (!dateFilter.from && !dateFilter.to) return uploadedData;\r\n    return uploadedData.filter(row => {\r\n      const rowDate = row.Date || row.TxnDate;\r\n      if (!rowDate) return false;\r\n      const d = new Date(rowDate);\r\n      const from = dateFilter.from ? new Date(dateFilter.from) : null;\r\n      const to = dateFilter.to ? new Date(dateFilter.to) : null;\r\n      if (from && d < from) return false;\r\n      if (to && d > to) return false;\r\n      return true;\r\n    });\r\n  };\r\n \r\n  const filteredExcelData = getFilteredUploadedData();\r\n  const metrics = getExcelMetrics(filteredExcelData);\r\n \r\n  const renderExcelCards = (metrics) => (\r\n    <div style={{ display: 'flex', gap: 24, marginBottom: 24 }}>\r\n      <div\r\n        className=\"card\"\r\n        style={{ flex: 1, background: '#e0f2fe', padding: 18, borderRadius: 8, cursor: 'pointer' }}\r\n        onClick={() => setShowAmountPopup(true)}\r\n        title=\"Click to view breakdown\"\r\n      >\r\n        <h4>Total Amount</h4>\r\n        <div style={{ fontSize: 28, fontWeight: 700 }}>{metrics.totalAmount.toLocaleString()}</div>\r\n      </div>\r\n      <div className=\"card\" style={{ flex: 1, background: '#fef9c3', padding: 18, borderRadius: 8 }}>\r\n        <h4>Categories</h4>\r\n        <ul style={{ margin: 0, padding: 0, listStyle: 'none' }}>\r\n          {Object.entries(metrics.byCategory).map(([cat, amt]) => (\r\n            <li key={cat} style={{ fontSize: 16 }}>{cat}: <b>{amt.toLocaleString()}</b></li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n      <div className=\"card\" style={{ flex: 1, background: '#dcfce7', padding: 18, borderRadius: 8 }}>\r\n        <h4>Expense Types</h4>\r\n        <ul style={{ margin: 0, padding: 0, listStyle: 'none' }}>\r\n          {Object.entries(metrics.byExpenseType).map(([type, amt]) => (\r\n            <li key={type} style={{ fontSize: 16 }}>{type}: <b>{amt.toLocaleString()}</b></li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n \r\n  const renderExcelCharts = (metrics) => (\r\n    <div style={{ display: 'flex', gap: 32, marginBottom: 24 }}>\r\n      <div style={{ flex: 1 }}>\r\n        <h4>Amount by Category</h4>\r\n        <Pie\r\n          data={{\r\n            labels: Object.keys(metrics.byCategory),\r\n            datasets: [{\r\n              data: Object.values(metrics.byCategory),\r\n              backgroundColor: ['#3b82f6', '#10b981', '#f59e42', '#f43f5e', '#6366f1', '#fef9c3'],\r\n            }]\r\n          }}\r\n          options={{ plugins: { legend: { position: 'bottom' } } }}\r\n        />\r\n      </div>\r\n      <div style={{ flex: 1 }}>\r\n        <h4>Amount by Expense Type</h4>\r\n        <Bar\r\n          data={{\r\n            labels: Object.keys(metrics.byExpenseType),\r\n            datasets: [{\r\n              label: 'Amount',\r\n              data: Object.values(metrics.byExpenseType),\r\n              backgroundColor: '#3b82f6',\r\n            }]\r\n          }}\r\n          options={{\r\n            plugins: { legend: { display: false } },\r\n            scales: { y: { beginAtZero: true } }\r\n          }}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n \r\n  const renderRecentTransactions = (data) => (\r\n    <div style={{ marginBottom: 24 }}>\r\n      <h4>Recent Transactions</h4>\r\n      <div style={{ display: 'flex', gap: 16, flexWrap: 'wrap' }}>\r\n        {data.slice(0, 5).map((row, idx) => (\r\n          <div key={idx} style={{\r\n            background: '#fff', border: '1px solid #eee', borderRadius: 8, padding: 14, minWidth: 180, boxShadow: '0 2px 8px #f3f4f6'\r\n          }}>\r\n            <div style={{ fontWeight: 600 }}>{row.Category || 'Uncategorized'}</div>\r\n            <div style={{ color: '#3b82f6', fontSize: 18 }}>{Number(row.Amount || 0).toLocaleString()}</div>\r\n            <div style={{ fontSize: 12, color: '#666' }}>{row.ExpenseType || 'Expense'} | {row.Date || row.TxnDate}</div>\r\n            <div style={{ fontSize: 12, color: '#888' }}>{row.Note || row.Description}</div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n \r\n  // Helper to extract initial amount from uploaded Excel data\r\nconst getInitialAmountFromExcel = (data) => {\r\n  if (!data || !data.length) return 0;\r\n  // Look for a row with Category: \"Initial\" or ExpenseType: \"Initial\"\r\n  const initialRow = data.find(\r\n    row =>\r\n      (row.Category && row.Category.toLowerCase() === 'initial') ||\r\n      (row.ExpenseType && row.ExpenseType.toLowerCase() === 'initial')\r\n  );\r\n  if (initialRow) {\r\n    return Number(initialRow.Amount || 0);\r\n  }\r\n  // Optionally, fallback to first row if you want\r\n  // return Number(data[0].Amount || 0);\r\n  return 0;\r\n};\r\n \r\n  const getAmountBreakdown = (data) => {\r\n    // Dynamically get initial amount from Excel\r\n    const initialAmount = getInitialAmountFromExcel(data);\r\n \r\n    let totalExpenses = 0;\r\n    let totalIncome = 0;\r\n    const expenseDetails = {};\r\n    const incomeDetails = {};\r\n \r\n    data.forEach(row => {\r\n      // Skip initial amount row from expense/income calculation\r\n      const isInitial =\r\n        (row.Category && row.Category.toLowerCase() === 'initial') ||\r\n        (row.ExpenseType && row.ExpenseType.toLowerCase() === 'initial');\r\n      if (isInitial) return;\r\n \r\n      const amt = Number(row.Amount || 0);\r\n      const type = (row.Category || '').toLowerCase();\r\n      const expType = row.ExpenseType || 'Expense';\r\n \r\n      if (type === 'expense' || expType.toLowerCase() === 'expense') {\r\n        totalExpenses += amt;\r\n        expenseDetails[expType] = (expenseDetails[expType] || 0) + amt;\r\n      } else if (type === 'receipt' || expType.toLowerCase() === 'receipt' || expType.toLowerCase() === 'income') {\r\n        totalIncome += amt;\r\n        incomeDetails[expType] = (incomeDetails[expType] || 0) + amt;\r\n      }\r\n    });\r\n \r\n    const remaining = initialAmount + totalIncome - totalExpenses;\r\n    return { initialAmount, totalExpenses, totalIncome, remaining, expenseDetails, incomeDetails };\r\n};\r\n \r\n  // Helper to group non-project transactions\r\n  function getOtherTransactions(data) {\r\n    return data.filter(row => !row.ProjectID && !row.ProjectName && !row.projectId && !row.projectName);\r\n  }\r\n \r\n  // Helper to create \"Other\" pseudo-project\r\n  function getOtherProject(data) {\r\n    const otherTxs = getOtherTransactions(data);\r\n    if (!otherTxs.length) return null;\r\n    const ar = otherTxs\r\n      .filter(tx => (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'income' || (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'receipt')\r\n      .reduce((sum, tx) => sum + Number(tx.Amount || tx.amount || 0), 0);\r\n    const ap = otherTxs\r\n      .filter(tx => (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'expense')\r\n      .reduce((sum, tx) => sum + Number(tx.Amount || tx.amount || 0), 0);\r\n    return {\r\n      id: 'other',\r\n      name: 'Other (Non-Project)',\r\n      transactions: otherTxs,\r\n      ar,\r\n      ap,\r\n      profit: ar - ap,\r\n    };\r\n  }\r\n \r\n  const projectsData = projectsFromFile.length > 0 ? projectsFromFile : getFilteredProjects();\r\n  let dashboardProjects = [...projectsData];\r\n \r\n  // If uploadedData or API data contains non-project transactions, add \"Other\" pseudo-project\r\n  if (uploadedData.length > 0) {\r\n    const otherProject = getOtherProject(uploadedData);\r\n    if (otherProject) dashboardProjects.push(otherProject);\r\n  } else if (selectedOrg && selectedOrg.projects) {\r\n    // If using API data, you may need to fetch organization-level transactions and add here\r\n    // Example: selectedOrg.organizationTransactions (if available from API)\r\n    // const otherProject = getOtherProject(selectedOrg.organizationTransactions || []);\r\n    // if (otherProject) dashboardProjects.push(otherProject);\r\n  }\r\n \r\n  return (\r\n    <>\r\n      <Header isLoggedIn={isLoggedIn} onLogout={onLogout} />\r\n      {view === 'organizations' && (\r\n        <OrganizationSelector\r\n          organizations={organizations}\r\n          onSelect={handleOrgSelect}\r\n        />\r\n      )}\r\n\r\n      {view === 'project' && selectedProject && (\r\n        <ProjectDashboard\r\n          project={selectedProject}\r\n          organization={selectedOrg}\r\n          onBack={handleBack}\r\n        />\r\n      )}\r\n\r\n      {view === 'dashboard' && (\r\n        <>\r\n          <CompanyDashboard\r\n            organization={selectedOrg}\r\n            selectedDept={selectedDept}\r\n            onDeptChange={setSelectedDept}\r\n            onProjectSelect={handleProjectSelect}\r\n            onAddProject={setShowNewProjectForm}\r\n            onFileUpload={handleFileUpload}\r\n            onBack={handleBack}\r\n            projects={dashboardProjects}\r\n            totals={calculateTotals(dashboardProjects)}\r\n          />\r\n          {showNewProjectForm && selectedOrg && (\r\n            <NewProjectModal\r\n              organizationId={selectedOrg.id}\r\n              departments={departments}\r\n              onCreated={handleProjectCreated}\r\n              onCancel={() => setShowNewProjectForm(false)}\r\n            />\r\n          )}\r\n        </>\r\n      )}\r\n\r\n      {/* Amount Breakdown Popup */}\r\n      {showAmountPopup && uploadedData.length > 0 && (\r\n        <AmountBreakdownPopup\r\n          breakdown={getAmountBreakdown(uploadedData)}\r\n          onClose={() => setShowAmountPopup(false)}\r\n        />\r\n      )}\r\n      {uploadError && (\r\n  <div style={{ color: 'red', margin: '12px 0', fontWeight: 600 }}>\r\n    {uploadError}\r\n  </div>\r\n)}\r\n    </>\r\n  );\r\n};\r\n \r\nconst AmountBreakdownPopup = ({ breakdown, onClose }) => (\r\n  <div style={{\r\n    position: 'fixed', top: 0, left: 0, width: '100vw', height: '100vh',\r\n    background: 'rgba(0,0,0,0.35)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 9999\r\n  }}>\r\n    <div style={{\r\n      background: '#fff', borderRadius: 10, padding: 32, minWidth: 340, boxShadow: '0 4px 24px #0002', position: 'relative'\r\n    }}>\r\n      <button\r\n        onClick={onClose}\r\n        style={{\r\n          position: 'absolute', top: 12, right: 16, background: 'none', border: 'none', fontSize: 22, cursor: 'pointer'\r\n        }}\r\n        aria-label=\"Close\"\r\n      >Ã—</button>\r\n      <h2 style={{ marginTop: 0 }}>Total Amount Breakdown</h2>\r\n      <div style={{ marginBottom: 16 }}>\r\n        <b>Initial Amount:</b> â‚¹{breakdown.initialAmount.toLocaleString()}\r\n      </div>\r\n      <div style={{ marginBottom: 16 }}>\r\n        <b>Total Expenses:</b> â‚¹{breakdown.totalExpenses.toLocaleString()}\r\n        <ul style={{ margin: '8px 0 0 16px', padding: 0 }}>\r\n          {Object.entries(breakdown.expenseDetails).map(([cat, amt]) => (\r\n            <li key={cat}>{cat}: â‚¹{amt.toLocaleString()}</li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n      <div style={{ marginBottom: 16 }}>\r\n        <b>Total Income:</b> â‚¹{breakdown.totalIncome.toLocaleString()}\r\n        <ul style={{ margin: '8px 0 0 16px', padding: 0 }}>\r\n          {Object.entries(breakdown.incomeDetails).map(([cat, amt]) => (\r\n            <li key={cat}>{cat}: â‚¹{amt.toLocaleString()}</li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n      <div style={{ fontSize: 18, fontWeight: 600, color: '#10b981' }}>\r\n        Remaining Balance: â‚¹{breakdown.remaining.toLocaleString()}\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n \r\nconst parseFile = async (file) => {\r\n  // CSV\r\n  if (file.name.endsWith('.csv')) {\r\n    return new Promise((resolve, reject) => {\r\n      Papa.parse(file, {\r\n        header: true,\r\n        skipEmptyLines: true,\r\n        complete: (results) => resolve(results.data),\r\n        error: (err) => reject(err)\r\n      });\r\n    });\r\n  }\r\n  // Excel (xlsx/xls)\r\n  if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => {\r\n        const data = new Uint8Array(e.target.result);\r\n        const workbook = XLSX.read(data, { type: 'array' });\r\n        const sheetName = workbook.SheetNames[0];\r\n        const worksheet = workbook.Sheets[sheetName];\r\n        const json = XLSX.utils.sheet_to_json(worksheet, { defval: '' });\r\n        resolve(json);\r\n      };\r\n      reader.onerror = reject;\r\n      reader.readAsArrayBuffer(file);\r\n    });\r\n  }\r\n  throw new Error('Unsupported file type');\r\n};\r\n\r\nfunction groupProjectsById(data) {\r\n  const projectsMap = {};\r\n  data.forEach(row => {\r\n    const pid = row.ProjectID || row.projectId || row.project_id || row.ProjectName || row.projectName;\r\n    if (!pid) return;\r\n    if (!projectsMap[pid]) {\r\n      projectsMap[pid] = {\r\n        id: pid,\r\n        name: row.ProjectName || row.projectName || `Project ${pid}`,\r\n        transactions: [],\r\n        ar: 0,\r\n        ap: 0,\r\n        profit: 0,\r\n      };\r\n    }\r\n    projectsMap[pid].transactions.push(row);\r\n  });\r\n  // Calculate AR, AP, Profit for each project\r\n  Object.values(projectsMap).forEach(project => {\r\n    project.ar = project.transactions\r\n      .filter(tx => (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'income' || (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'receipt')\r\n      .reduce((sum, tx) => sum + Number(tx.Amount || tx.amount || 0), 0);\r\n    project.ap = project.transactions\r\n      .filter(tx => (tx.ExpenseType || tx.expenseType || '').toLowerCase() === 'expense')\r\n      .reduce((sum, tx) => sum + Number(tx.Amount || tx.amount || 0), 0);\r\n    project.profit = project.ar - project.ap;\r\n  });\r\n  return Object.values(projectsMap);\r\n}\r\n\r\nexport default OrganizationDashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}